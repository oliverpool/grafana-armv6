"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1337],{"./public/app/features/serviceaccounts/ServiceAccountsListPage.tsx":(e,s,t)=>{t.r(s),t.d(s,{default:()=>D,getStyles:()=>O});var n,i=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),a=t("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),c=t("./packages/grafana-ui/src/index.ts"),o=t("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/3/opt/drone/yarncache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),r=t("./public/app/core/components/Page/Page.tsx"),l=t("./public/app/types/index.ts"),d=t("./public/app/features/serviceaccounts/state/actions.ts"),u=t("./public/app/core/selectors/navModel.ts"),p=t("./public/app/core/components/PageLoader/PageLoader.tsx"),m=t("./public/app/core/core.ts"),h=t("../../opt/drone/yarncache/pluralize-npm-8.0.0-f5f044ed52-08931d4a6a.zip/node_modules/pluralize/pluralize.js"),x=t.n(h),v=t("./public/app/core/components/EmptyListCTA/EmptyListCTA.tsx"),b=t("./public/app/core/components/RolePicker/UserRolePicker.tsx"),g=t("./public/app/features/admin/OrgRolePicker.tsx"),j=t("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const f=e=>`Edit service account's ${e} details`,k=e=>e?"Disabled":"Enabled",A=(0,i.memo)((e=>{let{serviceAccount:s,onRoleChange:t,roleOptions:i,builtInRoles:a,onSetToRemove:r}=e;const d=`org/serviceaccounts/${s.id}`,u=(0,c.useStyles2)(O),p=m.Vt.hasPermissionInMetadata(l.bW.ServiceAccountsWrite,s),h=m.Vt.hasPermission(l.bW.ActionRolesList)&&m.Vt.hasPermission(l.bW.ActionUserRolesList),x=m.Vt.hasPermission(l.bW.OrgUsersRoleUpdate)&&p;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"width-4 text-center link-td",children:(0,j.jsx)("a",{href:d,"aria-label":f(s.name),children:(0,j.jsx)("img",{className:"filter-table__avatar",src:s.avatarUrl,alt:`Avatar for user ${s.name}`})})}),(0,j.jsx)("td",{className:"link-td max-width-10",children:(0,j.jsx)("a",{className:"ellipsis",href:d,title:s.name,"aria-label":f(s.name),children:s.name})}),(0,j.jsx)("td",{className:"link-td max-width-10",children:(0,j.jsx)("a",{className:"ellipsis",href:d,title:s.login,"aria-label":f(s.name),children:s.login})}),m.Vt.licensedAccessControlEnabled()?(0,j.jsx)("td",{className:(0,o.cx)("link-td",u.iconRow),children:h&&(0,j.jsx)(b.R,{userId:s.id,orgId:s.orgId,builtInRole:s.role,onBuiltinRoleChange:e=>t(e,s),roleOptions:i,builtInRoles:a,disabled:!x})}):(0,j.jsx)("td",{className:(0,o.cx)("link-td",u.iconRow),children:(0,j.jsx)(g.A,{"aria-label":"Role",value:s.role,disabled:!p,onChange:e=>t(e,s)})}),(0,j.jsx)("td",{className:"link-td max-width-10",children:(0,j.jsx)("a",{className:"ellipsis",href:d,title:k(s.isDisabled),"aria-label":f(s.name),children:k(s.isDisabled)})}),(0,j.jsx)("td",{className:"link-td max-width-10",children:(0,j.jsxs)("a",{className:"ellipsis",href:d,title:"Tokens","aria-label":f(s.name),children:[n||(n=(0,j.jsx)("span",{children:(0,j.jsx)(c.Icon,{name:"key-skeleton-alt"})})),"Â ",s.tokens]})}),m.Vt.hasPermissionInMetadata(l.bW.ServiceAccountsDelete,s)&&(0,j.jsx)("td",{children:(0,j.jsx)(c.Button,{size:"sm",variant:"destructive",onClick:()=>{r(s)},icon:"times","aria-label":"Delete service account"})})]},s.id)}));A.displayName="ServiceAccountListItem";const y=A;var R,S,C,T,I,N,P,_,L;const w={fetchServiceAccounts:d.Xd,fetchACOptions:d.bX,updateServiceAccount:d.TL,removeServiceAccount:d.IR,setServiceAccountToRemove:d.cl,changeFilter:d.M6,changeQuery:d.R5},$=(0,a.connect)((function(e){return Object.assign({navModel:(0,u.h)(e.navIndex,"serviceaccounts")},e.serviceAccounts)}),w),O=e=>({table:o.css`
      margin-top: ${e.spacing(3)};
    `,filter:o.css`
      margin: 0 ${e.spacing(1)};
    `,iconRow:o.css`
      svg {
        margin-left: ${e.spacing(.5)};
      }
    `,row:o.css`
      display: flex;
      align-items: center;
      height: 100% !important;

      a {
        padding: ${e.spacing(.5)} 0 !important;
      }
    `,unitTooltip:o.css`
      display: flex;
      flex-direction: column;
    `,unitItem:o.css`
      cursor: pointer;
      padding: ${e.spacing(.5)} 0;
      margin-right: ${e.spacing(1)};
    `,disabled:o.css`
      color: ${e.colors.text.disabled};
    `,link:o.css`
      color: inherit;
      cursor: pointer;
      text-decoration: underline;
    `}),D=$((e=>{var s;let{fetchServiceAccounts:t,removeServiceAccount:n,fetchACOptions:a,updateServiceAccount:d,setServiceAccountToRemove:u,navModel:h,serviceAccounts:b,isLoading:g,roleOptions:f,builtInRoles:k,changeFilter:A,changeQuery:w,query:$,filters:D,serviceAccountToRemove:z}=e;const V=(0,c.useStyles2)(O);(0,i.useEffect)((()=>{t(),m.Vt.licensedAccessControlEnabled()&&a()}),[t,a]);const E=(e,s)=>{const t=Object.assign({},s,{role:e});d(t)};return(0,j.jsx)(r.Z,{navModel:h,children:(0,j.jsxs)(r.Z.Contents,{children:[R||(R=(0,j.jsx)("h2",{children:"Service accounts"})),(0,j.jsxs)("div",{className:"page-action-bar",style:{justifyContent:"flex-end"},children:[(0,j.jsx)(c.FilterInput,{placeholder:"Search service account by name.",autoFocus:!0,value:$,onChange:w}),(0,j.jsx)(c.RadioButtonGroup,{options:[{label:"All service accounts",value:!1},{label:"Expired tokens",value:!0}],onChange:e=>A({name:"expiredTokens",value:e}),value:null===(s=D.find((e=>"expiredTokens"===e.name)))||void 0===s?void 0:s.value,className:V.filter}),0!==b.length&&m.Vt.hasPermission(l.bW.ServiceAccountsCreate)&&(S||(S=(0,j.jsx)(c.LinkButton,{href:"org/serviceaccounts/create",variant:"primary",children:"Add service account"})))]}),g&&(C||(C=(0,j.jsx)(p.Z,{}))),!g&&0===b.length&&(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(v.Z,{title:"You haven't created any service accounts yet.",buttonIcon:"key-skeleton-alt",buttonLink:"org/serviceaccounts/create",buttonTitle:"Add service account",buttonDisabled:!m.Vt.hasPermission(l.bW.ServiceAccountsCreate),proTip:"Remember, you can provide specific permissions for API access to other applications.",proTipLink:"",proTipLinkTitle:"",proTipTarget:"_blank"})}),!g&&0!==b.length&&(0,j.jsx)(j.Fragment,{children:(0,j.jsx)("div",{className:(0,o.cx)(V.table,"admin-list-table"),children:(0,j.jsxs)("table",{className:"filter-table form-inline filter-table--hover",children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[T||(T=(0,j.jsx)("th",{})),I||(I=(0,j.jsx)("th",{children:"Account"})),N||(N=(0,j.jsx)("th",{children:"ID"})),P||(P=(0,j.jsx)("th",{children:"Roles"})),_||(_=(0,j.jsx)("th",{children:"Status"})),L||(L=(0,j.jsx)("th",{children:"Tokens"})),(0,j.jsx)("th",{style:{width:"34px"}})]})}),(0,j.jsx)("tbody",{children:b.map((e=>(0,j.jsx)(y,{serviceAccount:e,builtInRoles:k,roleOptions:f,onRoleChange:E,onSetToRemove:u},e.id)))})]})})}),z&&(0,j.jsx)(c.ConfirmModal,{body:(0,j.jsxs)("div",{children:["Are you sure you want to delete '",z.name,"'",Boolean(z.tokens)&&` and ${z.tokens} accompanying ${x()("token",z.tokens)}`,"?"]}),confirmText:"Delete",title:"Delete service account",onDismiss:()=>{u(null)},isOpen:!0,onConfirm:()=>{n(z.id),u(null)}})]})})}))}}]);
//# sourceMappingURL=ServiceAccountsPage.15718e8e3083449662a7.js.map