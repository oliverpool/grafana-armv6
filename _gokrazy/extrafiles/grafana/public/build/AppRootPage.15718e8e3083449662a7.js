"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[295],{"./public/app/angular/core_module.ts":(e,t,n)=>{n.d(t,{ZP:()=>s,hF:()=>a,rb:()=>i});var o=n("../../opt/drone/yarncache/angular-npm-1.8.2-307000482b-35ea81a23b.zip/node_modules/angular/index.js"),r=n.n(o);const a=r().module("grafana.core",["ngRoute"]),i=[a,r().module("grafana.controllers",[]),r().module("grafana.directives",[]),r().module("grafana.factories",[]),r().module("grafana.services",[]),r().module("grafana.filters",[]),r().module("grafana.routes",[])],s=a},"./public/app/features/plugins/components/AppRootPage.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>I,getAppPluginPageError:()=>E});var o,r=n("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),a=n("./packages/grafana-data/src/index.ts"),i=n("./.yarn/__virtual__/react-dom-virtual-93e2c4839c/3/opt/drone/yarncache/react-dom-npm-17.0.2-f551215af1-1c1eaa3bca.zip/node_modules/react-dom/index.js"),s=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p="html",l="svg",c=function(e,t){var n,o,r,a={};if(e===p)r=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');r=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var i=0,s=Object.entries(t.attributes);i<s.length;i++){var c=s[i],u=c[0],d=c[1];r.setAttribute(u,d)}var h={element:r,elementType:e,setPortalProps:function(e){a=e},getInitialPortalProps:function(){return a},mount:function(t,r){if(r!==o){if(h.unmount(),t!==n&&!function(e,t){if(t===p)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(h.element,r),n=t,o=r}},unmount:function(e){e&&e!==o||n&&o&&(n.replaceChild(o,h.element),n=void 0,o=void 0)}};return h},u=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return s(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,o=t.node;return i.createPortal(r.Children.map(n,(function(t){return r.isValidElement(t)?r.cloneElement(t,e.state.nodeProps):t})),o.element)},t}(r.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=r.createRef(),n.passPropsThroughPortal(),n}return s(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return r.createElement("div",{ref:this.placeholderNode})},t}(r.PureComponent),h=c.bind(null,p),m=(c.bind(null,l),n("./public/app/core/components/Page/Page.tsx")),f=n("./public/app/features/plugins/pluginSettings.ts"),g=n("./public/app/features/plugins/plugin_loader.ts"),v=n("./public/app/angular/core_module.ts"),b=n("./public/app/core/config.ts");class P{constructor(){var e,t,n;n=void 0,(t="navItems")in(e=this)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,this.navItems=b.ZP.bootData.navTree}getCfgNode(){return this.navItems.find((e=>"cfg"===e.id))}getNav(){var e;let t=this.navItems;const n={breadcrumbs:[]};for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];for(const e of r){if("number"==typeof e){n.main=n.breadcrumbs[e];break}const o=t.find((t=>t.id===e));var i;if(o)n.breadcrumbs.push(o),n.node=o,n.main=o,t=null!==(i=o.children)&&void 0!==i?i:[]}if(null!==(e=n.main)&&void 0!==e&&e.children)for(const e of n.main.children){var s;e.active=e.url===(null===(s=n.node)||void 0===s?void 0:s.url)}return n}getNotFoundNav(){return y()}}function y(){return N("Page not found","404 Error")}function N(e,t){const n={text:e,subTitle:t,icon:"exclamation-triangle"};return{breadcrumbs:[n],node:n,main:n}}P.$inject=[],v.ZP.service("navModelSrv",P);var j,w,x=n("./public/app/core/core.ts"),_=n("./public/app/core/components/PageLoader/PageLoader.tsx"),C=n("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");function E(e){return e?e.type!==a.PluginType.app?"Plugin must be an app":e.enabled?null:"Application Not Enabled":"Unknown Plugin"}class S extends r.Component{constructor(e){var t,n,o;super(e),o=e=>{this.setState({nav:e})},(n="onNavChanged")in(t=this)?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,this.state={loading:!0,portalNode:h()}}shouldComponentUpdate(e){return e.location.pathname.startsWith("/a/")}async loadPluginSettings(){const{params:e}=this.props.match;try{const t=await(0,f.a)(e.pluginId).then((e=>{const t=E(e);return t?(x.h$.emit(a.AppEvents.alertError,[t]),this.setState({nav:N(t)}),null):(0,g.Av)(e)}));this.setState({plugin:t,loading:!1,nav:void 0})}catch(e){this.setState({plugin:null,loading:!1,nav:y()})}}componentDidMount(){this.loadPluginSettings()}componentDidUpdate(e){const{params:t}=this.props.match;e.match.params.pluginId!==t.pluginId&&(this.setState({loading:!0}),this.loadPluginSettings())}render(){const{loading:e,plugin:t,nav:n,portalNode:o}=this.state;return t&&!t.root?j||(j=(0,C.jsx)("div",{children:"No Root App"})):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(u,{node:o,children:t&&t.root&&(0,C.jsx)(t.root,{meta:t.meta,basename:this.props.match.url,onNavChanged:this.onNavChanged,query:this.props.queryParams,path:this.props.location.pathname})}),n?(0,C.jsx)(m.Z,{navModel:n,children:(0,C.jsx)(m.Z.Contents,{isLoading:e,children:(0,C.jsx)(d,{node:o})})}):(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(d,{node:o}),e&&(w||(w=(0,C.jsx)(_.Z,{})))]})]})}}const I=S}}]);
//# sourceMappingURL=AppRootPage.15718e8e3083449662a7.js.map