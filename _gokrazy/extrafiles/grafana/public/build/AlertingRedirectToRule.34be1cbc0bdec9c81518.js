"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7918],{81471:(x,U,e)=>{e.r(U),e.d(U,{RedirectToRuleViewer:()=>C,default:()=>w});var v=e(52423),a=e(68404),O=e(70356),E=e(44870),P=function(c){var p=window.history,i=p[c];p[c]=function(R){var m=i.apply(this,arguments),D=new Event(c.toLowerCase());return D.state=R,window.dispatchEvent(D),m}};E.jU&&(P("pushState"),P("replaceState"));var A=function(){return{trigger:"load",length:1}},T=function(c){var p=window.history,i=p.state,R=p.length,m=window.location,D=m.hash,_=m.host,K=m.hostname,L=m.href,b=m.origin,G=m.pathname,V=m.port,Z=m.protocol,j=m.search;return{trigger:c,state:i,length:R,hash:D,host:_,hostname:K,href:L,origin:b,pathname:G,port:V,protocol:Z,search:j}},I=function(){var c=(0,a.useState)(T("load")),p=c[0],i=c[1];return(0,a.useEffect)(function(){var R=function(){return i(T("popstate"))},m=function(){return i(T("pushstate"))},D=function(){return i(T("replacestate"))};return(0,E.on)(window,"popstate",R),(0,E.on)(window,"pushstate",m),(0,E.on)(window,"replacestate",D),function(){(0,E.S1)(window,"popstate",R),(0,E.S1)(window,"pushstate",m),(0,E.S1)(window,"replacestate",D)}},[]),p},B=typeof Event=="function";const h=E.jU&&B?I:A;var g=e(29516),y=e(2323),W=e(90090),u=e(66208),f=e(81697),M=e(78758),t=e(52694),s=e(28104),n=e(76277),o=e(45849),l=e(10505);const r="Find rule";function d(){const p=h().pathname?.split("/")??[],i=decodeURIComponent(p[3]),R=decodeURIComponent(p[2]);return{name:i,sourceName:R}}function C(){const c=(0,g.wW)($),{name:p,sourceName:i}=d(),{error:R,loading:m,result:D,dispatched:_}=(0,n.X)(p,i);if(R)return a.createElement(s.$,{title:r},a.createElement(y.b,{title:`Failed to load rules from ${i}`},a.createElement("details",{className:c.errorMessage},R.message,a.createElement("br",null),!!R?.stack&&R.stack)));if(m||!_||!Array.isArray(D))return a.createElement(s.$,{title:r},a.createElement(W.u,{text:"Loading rule..."}));if(!p||!i)return a.createElement(O.l_,{to:"/notfound"});const K=(0,o.o_)(i);if(!K)return a.createElement(s.$,{title:r},a.createElement(y.b,{title:"Could not view rule"},a.createElement("details",{className:c.errorMessage},`Could not find data source with name: ${i}.`)));if(D.length===1){const[L]=D;return a.createElement(O.l_,{to:(0,l.V2)(K,L,"/alerting/list")})}return a.createElement(s.$,{title:r},a.createElement("div",null,"Several rules in ",a.createElement("span",{className:c.param},i)," matched the name"," ",a.createElement("span",{className:c.param},p),", please select the rule you want to view."),a.createElement("div",{className:c.rules},D.map((L,b)=>a.createElement(u.Z,{key:`${L.name}-${b}`,href:(0,l.V2)(K,L,"/alerting/list")},a.createElement(u.Z.Heading,null,L.name),a.createElement(u.Z.Meta,{separator:""},a.createElement(f.J,{name:"folder"}),a.createElement("span",{className:c.namespace},`${L.namespace.name} / ${L.group.name}`)),a.createElement(u.Z.Tags,null,a.createElement(t.s,{labels:L.labels}))))))}function $(c){return{param:v.css`
      font-style: italic;
      color: ${c.colors.text.secondary};
    `,rules:v.css`
      margin-top: ${c.spacing(2)};
    `,namespace:v.css`
      margin-left: ${c.spacing(1)};
    `,errorMessage:v.css`
      white-space: pre-wrap;
    `}}const w=(0,M.Pf)(C,{style:"page"})},28104:(x,U,e)=>{e.d(U,{$:()=>A,l:()=>T});var v=e(52423),a=e(68404),O=e(29516),E=e(79396);const P={icon:"bell",id:"alert-rule-view",breadcrumbs:[{title:"Alert rules",url:"alerting/list"}]};function A(h){const{wrapInContent:g=!0,children:y,title:W}=h,u=(0,O.wW)(I);return a.createElement(E.T,{pageNav:{...P,text:W},navId:"alert-list"},a.createElement(E.T.Contents,null,a.createElement("div",{className:u.content},g?a.createElement(T,{...h}):y)))}function T({children:h,padding:g=2}){const y=(0,O.wW)(B(g));return a.createElement("div",{className:y.wrapper},h)}const I=h=>({content:v.css`
      max-width: ${h.breakpoints.values.xxl}px;
    `}),B=h=>g=>({wrapper:v.css`
      background: ${g.colors.background.primary};
      border: 1px solid ${g.colors.border.weak};
      border-radius: ${g.shape.borderRadius()};
      padding: ${g.spacing(h)};
    `})},76277:(x,U,e)=>{e.d(U,{H:()=>h,X:()=>g});var v=e(68404),a=e(22350),O=e(81168),E=e(72004),P=e(46818),A=e(60048),T=e(79662),I=e(61627),B=e(79370);function h(u,f){const M=y(f),t=(0,I.Zo)(f),s=(0,v.useMemo)(()=>{if(!(!u||!f||t.length===0))for(const n of t)for(const o of n.groups)for(const l of o.rules){const r=A.Yd(f,l);if(A.Dg(r,u))return l}},[u,f,t]);return{...M,result:s}}function g(u,f){const M=y(f),t=(0,I.Zo)(f),s=(0,v.useMemo)(()=>{if(!u||!f||t.length===0)return[];const n=[];for(const o of t)for(const l of o.groups)for(const r of l.rules)r.name===u&&n.push(r);return n},[u,f,t]);return{...M,result:s}}function y(u){const f=(0,O.useDispatch)(),M=(0,B._)(l=>l.promRules),t=W(u,M),s=(0,B._)(l=>l.rulerRules),n=W(u,s),{loading:o}=(0,a.Z)(async()=>{u&&await f((0,E.dn)({rulesSourceName:u}))},[f,u]);return{loading:o,error:t.error??(0,T.m$)(n)?void 0:n.error,dispatched:t.dispatched&&n.dispatched}}function W(u,f){if(!u)return P.oq;const M=f[u];return M||P.oq}},61627:(x,U,e)=>{e.d(U,{Kd:()=>I,Zo:()=>T});var v=e(82897),a=e.n(v),O=e(68404),E=e(45849),P=e(79662),A=e(79370);function T(t){const s=(0,A._)(r=>r.promRules),n=(0,A._)(r=>r.rulerRules),o=(0,O.useRef)({}),l=(0,O.useMemo)(()=>{if(t){const r=(0,E.o_)(t);if(!r)throw new Error(`Unknown rules source: ${t}`);return[r]}return(0,E.h_)()},[t]);return(0,O.useMemo)(()=>l.map(r=>{const d=(0,E.jq)(r)?r.name:r,C=s[d]?.result,$=n[d]?.result,w=o.current[d];if(w&&w.promRules===C&&w.rulerRules===$)return w.result;const c={};Object.entries($||{}).forEach(([i,R])=>{const m={rulesSource:r,name:i,groups:[]};c[i]=m,h(m,R)}),C?.forEach(({name:i,groups:R})=>{const m=c[i]=c[i]||{rulesSource:r,name:i,groups:[]};g(m,R)});const p=Object.values(c);return o.current[d]={promRules:C,rulerRules:$,result:p},p}).flat(),[s,n,l])}function I(t){return t.map(s=>{const n={...s,groups:[]};return n.groups.push({name:"default",rules:B(s.groups.flatMap(o=>o.rules))}),n})}function B(t){return t.sort((s,n)=>s.name.localeCompare(n.name))}function h(t,s=[]){t.groups=s.map(n=>{const o={name:n.name,interval:n.interval,source_tenants:n.source_tenants,rules:[]};return o.rules=n.rules.map(l=>W(l,t,o)),o})}function g(t,s){const n=new Map;t.groups.forEach(o=>n.set(o.name,o)),s.forEach(o=>{let l=n.get(o.name);l||(l={name:o.name,rules:[]},t.groups.push(l),n.set(o.name,l));const r=new Map;l.rules.forEach(d=>{const C=r.get(d.name);C?C.push(d):r.set(d.name,[d])}),(o.rules??[]).forEach(d=>{const C=u(d,r,t.rulesSource);C?C.promRule=d:l.rules.push(y(d,t,l))})})}function y(t,s,n){return{name:t.name,query:t.query,labels:t.labels||{},annotations:(0,P.x_)(t)?t.annotations||{}:{},promRule:t,namespace:s,group:n}}function W(t,s,n){return(0,P.cG)(t)?{name:t.alert,query:t.expr,labels:t.labels||{},annotations:t.annotations||{},rulerRule:t,namespace:s,group:n}:(0,P.yF)(t)?{name:t.record,query:t.expr,labels:t.labels||{},annotations:{},rulerRule:t,namespace:s,group:n}:{name:t.grafana_alert.title,query:"",labels:t.labels||{},annotations:t.annotations||{},rulerRule:t,namespace:s,group:n}}function u(t,s,n){const o=s.get(t.name);if(!o)return;if((0,E.HY)(n))return o[0];const l=o.find(d=>!d.promRule&&f(d,t,!0));if(l)return l;const r=o.find(d=>!d.promRule&&f(d,t,!1));if(r)return r}function f(t,s,n=!0){return t.name===s.name?(0,v.isEqual)([n?M(t.query):"",t.labels,t.annotations],[n?M(s.query):"",s.labels||{},(0,P.x_)(s)?s.annotations||{}:{}]):!1}function M(t){return t.length>1&&t[0]==="("&&t[t.length-1]===")"&&(t=t.slice(1,-1)),t=t.replace(/\s|\n/g,""),t.split("").sort().join("")}}}]);

//# sourceMappingURL=AlertingRedirectToRule.34be1cbc0bdec9c81518.js.map