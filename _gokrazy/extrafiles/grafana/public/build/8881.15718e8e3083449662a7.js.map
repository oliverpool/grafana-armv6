{"version":3,"file":"8881.15718e8e3083449662a7.js","mappings":"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","sources":["webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/Field.tsx","webpack://grafana/./public/app/core/utils/deferred.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/LogsQueryEditor/QueryField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/LogsQueryEditor/FormatAsField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/EntryIcon.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/styles.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/NestedEntry.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/NestedRow.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/NestedRows.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/NestedResourceTable.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/ResourcePicker.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/LogsQueryEditor/ResourceField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/LogsQueryEditor/useMigrations.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/LogsQueryEditor/LogsQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/LogsQueryEditor/setQueryValue.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/setQueryValue.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/SubscriptionField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ArgQueryEditor/QueryField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ArgQueryEditor/ArgQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/deprecated/components/ApplicationInsightsEditor/index.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/deprecated/components/InsightsAnalyticsEditor/index.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/MetricNamespaceField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/ResourceTypeField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/ResourceGroupsField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/ResourceNameField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/MetricNameField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/AggregationField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/TimeGrainField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/DimensionFields.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/TopField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/LegendFormatField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/dataHooks.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/MetricsQueryEditor/MetricsQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/NewMetricsQueryEditor/MetricsQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/QueryEditor/QueryTypeField.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/QueryEditor/usePreparedQuery.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/QueryEditor/QueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/types.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/ResourcePicker/utils.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/Space.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/components/deprecated/utils.tsx","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/time_grain_converter.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/types/query.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/types/types.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/utils/common.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/utils/migrateQuery.ts","webpack://grafana/./public/app/plugins/datasource/grafana-azure-monitor-datasource/utils/useLastError.ts","webpack://grafana/../../opt/drone/yarncache/immer-npm-9.0.12-e8cd7358fa-bcbec6d76d.zip/node_modules/immer/dist/immer.esm.js"],"sourcesContent":["import { InlineField } from '@grafana/ui';\nimport React from 'react';\nimport { Props as InlineFieldProps } from '@grafana/ui/src/components/Forms/InlineField';\n\nconst DEFAULT_LABEL_WIDTH = 18;\n\nexport const Field = (props: InlineFieldProps) => {\n  return <InlineField labelWidth={DEFAULT_LABEL_WIDTH} {...props} />;\n};\n","export class Deferred<T = any> {\n  resolve?: (reason: T | PromiseLike<T>) => void;\n  reject?: (reason?: any) => void;\n  promise: Promise<T>;\n\n  constructor() {\n    this.resolve = undefined;\n    this.reject = undefined;\n\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n    });\n    Object.freeze(this);\n  }\n}\n","import { CodeEditor, Monaco, MonacoEditor } from '@grafana/ui';\nimport { Deferred } from 'app/core/utils/deferred';\nimport React, { useCallback, useEffect, useRef } from 'react';\n\nimport { AzureQueryEditorFieldProps } from '../../types';\nimport { setKustoQuery } from './setQueryValue';\n\ninterface MonacoPromise {\n  editor: MonacoEditor;\n  monaco: Monaco;\n}\n\ninterface MonacoLanguages {\n  kusto: {\n    getKustoWorker: () => Promise<\n      (url: any) => Promise<{\n        setSchema: (schema: any, clusterUrl: string, name: string) => void;\n      }>\n    >;\n  };\n}\n\nconst QueryField: React.FC<AzureQueryEditorFieldProps> = ({ query, datasource, onQueryChange }) => {\n  const monacoPromiseRef = useRef<Deferred<MonacoPromise>>();\n  function getPromise() {\n    if (!monacoPromiseRef.current) {\n      monacoPromiseRef.current = new Deferred<MonacoPromise>();\n    }\n\n    return monacoPromiseRef.current.promise;\n  }\n\n  useEffect(() => {\n    if (!query.azureLogAnalytics?.resource) {\n      return;\n    }\n\n    const promises = [\n      datasource.azureLogAnalyticsDatasource.getKustoSchema(query.azureLogAnalytics.resource),\n      getPromise(),\n    ] as const;\n\n    // the kusto schema call might fail, but its okay for that to happen silently\n    Promise.all(promises).then(([schema, { monaco, editor }]) => {\n      const languages = monaco.languages as unknown as MonacoLanguages;\n\n      languages.kusto\n        .getKustoWorker()\n        .then((kusto) => {\n          const model = editor.getModel();\n          return model && kusto(model.uri);\n        })\n        .then((worker) => {\n          worker?.setSchema(schema, 'https://help.kusto.windows.net', 'Samples');\n        });\n    });\n  }, [datasource.azureLogAnalyticsDatasource, query.azureLogAnalytics?.resource]);\n\n  const handleEditorMount = useCallback((editor: MonacoEditor, monaco: Monaco) => {\n    monacoPromiseRef.current?.resolve?.({ editor, monaco });\n  }, []);\n\n  const onChange = useCallback(\n    (newQuery: string) => {\n      onQueryChange(setKustoQuery(query, newQuery));\n    },\n    [onQueryChange, query]\n  );\n\n  return (\n    <CodeEditor\n      value={query.azureLogAnalytics?.query ?? ''}\n      language=\"kusto\"\n      height={200}\n      width=\"100%\"\n      showMiniMap={false}\n      onBlur={onChange}\n      onSave={onChange}\n      onEditorDidMount={handleEditorMount}\n    />\n  );\n};\n\nexport default QueryField;\n","import React, { useCallback, useMemo } from 'react';\nimport { SelectableValue } from '@grafana/data';\nimport { Select } from '@grafana/ui';\nimport { AzureQueryEditorFieldProps } from '../../types';\nimport { Field } from '../Field';\nimport { setFormatAs } from './setQueryValue';\n\nconst FORMAT_OPTIONS: Array<SelectableValue<string>> = [\n  { label: 'Time series', value: 'time_series' },\n  { label: 'Table', value: 'table' },\n];\n\nconst FormatAsField: React.FC<AzureQueryEditorFieldProps> = ({ query, variableOptionGroup, onQueryChange }) => {\n  const options = useMemo(() => [...FORMAT_OPTIONS, variableOptionGroup], [variableOptionGroup]);\n\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      const { value } = change;\n      if (!value) {\n        return;\n      }\n\n      const newQuery = setFormatAs(query, value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  return (\n    <Field label=\"Format as\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-logs-workspaces-field\"\n        value={query.azureLogAnalytics?.resultFormat}\n        onChange={handleChange}\n        options={options}\n        width={38}\n      />\n    </Field>\n  );\n};\n\nexport default FormatAsField;\n","import { Icon } from '@grafana/ui';\nimport React from 'react';\n\nimport { ResourceRow, ResourceRowType } from './types';\n\ninterface EntryIconProps {\n  entry: ResourceRow;\n  isOpen: boolean;\n}\n\nexport const EntryIcon: React.FC<EntryIconProps> = ({ isOpen, entry: { type } }) => {\n  switch (type) {\n    case ResourceRowType.Subscription:\n      return <Icon name=\"layer-group\" />;\n\n    case ResourceRowType.ResourceGroup:\n      return <Icon name={isOpen ? 'folder-open' : 'folder'} />;\n\n    case ResourceRowType.Resource:\n      return <Icon name=\"cube\" />;\n\n    case ResourceRowType.VariableGroup:\n      return <Icon name=\"x\" />;\n\n    case ResourceRowType.Variable:\n      return <Icon name=\"x\" />;\n\n    default:\n      return null;\n  }\n};\n","import { css } from '@emotion/css';\nimport { GrafanaTheme2 } from '@grafana/data';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  table: css({\n    width: '100%',\n    tableLayout: 'fixed',\n  }),\n\n  tableScroller: css({\n    maxHeight: '50vh',\n    overflow: 'auto',\n  }),\n\n  header: css({\n    background: theme.colors.background.secondary,\n  }),\n\n  row: css({\n    borderBottom: `1px solid ${theme.colors.border.weak}`,\n\n    '&:last-of-type': {\n      borderBottomColor: theme.colors.border.medium,\n    },\n  }),\n\n  disabledRow: css({\n    opacity: 0.5,\n  }),\n\n  cell: css({\n    padding: theme.spacing(1, 1, 1, 0),\n    width: '25%',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    '&:first-of-type': {\n      width: '50%',\n      padding: theme.spacing(1, 1, 1, 2),\n    },\n  }),\n\n  collapseButton: css({ margin: 0 }),\n\n  loadingCell: css({\n    textAlign: 'center',\n  }),\n\n  spinner: css({\n    marginBottom: 0,\n  }),\n\n  nestedEntry: css({\n    display: 'flex',\n    alignItems: 'center',\n  }),\n\n  entryContentItem: css({\n    margin: theme.spacing(0, 1, 0, 0),\n  }),\n\n  truncated: css({\n    minWidth: 0,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n  }),\n\n  nestedRowCheckbox: css({\n    zIndex: 0,\n  }),\n});\n\nexport default getStyles;\n","import { cx } from '@emotion/css';\nimport { Checkbox, IconButton, useStyles2, useTheme2 } from '@grafana/ui';\nimport React, { useCallback, useEffect } from 'react';\n\nimport { Space } from '../Space';\nimport { EntryIcon } from './EntryIcon';\nimport getStyles from './styles';\nimport { ResourceRow } from './types';\n\ninterface NestedEntryProps {\n  level: number;\n  entry: ResourceRow;\n  isSelected: boolean;\n  isSelectable: boolean;\n  isOpen: boolean;\n  isDisabled: boolean;\n  onToggleCollapse: (row: ResourceRow) => void;\n  onSelectedChange: (row: ResourceRow, selected: boolean) => void;\n}\n\nexport const NestedEntry: React.FC<NestedEntryProps> = ({\n  entry,\n  isSelected,\n  isDisabled,\n  isOpen,\n  isSelectable,\n  level,\n  onToggleCollapse,\n  onSelectedChange,\n}) => {\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const hasChildren = !!entry.children;\n  // Subscriptions, resource groups, resources, and variables are all selectable, so\n  // the top-level variable group is the only thing that cannot be selected.\n  // const isSelectable = entry.type !== ResourceRowType.VariableGroup;\n  // const isSelectable = selectableEntryTypes?.some((e) => e === entry.type);\n\n  const handleToggleCollapse = useCallback(() => {\n    onToggleCollapse(entry);\n  }, [onToggleCollapse, entry]);\n\n  const handleSelectedChanged = useCallback(\n    (ev: React.ChangeEvent<HTMLInputElement>) => {\n      const isSelected = ev.target.checked;\n      onSelectedChange(entry, isSelected);\n    },\n    [entry, onSelectedChange]\n  );\n\n  const checkboxId = `checkbox_${entry.id}`;\n\n  // Scroll to the selected element if it's not in the view\n  // Only do it once, when the component is mounted\n  useEffect(() => {\n    if (isSelected) {\n      document.getElementById(checkboxId)?.scrollIntoView({\n        behavior: 'smooth',\n        block: 'center',\n      });\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return (\n    <div className={styles.nestedEntry} style={{ marginLeft: level * (3 * theme.spacing.gridSize) }}>\n      {/* When groups are selectable, I *think* we will want to show a 2-wide space instead\n              of the collapse button for leaf rows that have no children to get them to align */}\n\n      {hasChildren ? (\n        <IconButton\n          className={styles.collapseButton}\n          name={isOpen ? 'angle-down' : 'angle-right'}\n          aria-label={isOpen ? `Collapse ${entry.name}` : `Expand ${entry.name}`}\n          onClick={handleToggleCollapse}\n          id={entry.id}\n        />\n      ) : (\n        <Space layout=\"inline\" h={2} />\n      )}\n\n      <Space layout=\"inline\" h={2} />\n\n      {isSelectable && (\n        <>\n          <Checkbox\n            id={checkboxId}\n            onChange={handleSelectedChanged}\n            disabled={isDisabled}\n            value={isSelected}\n            className={styles.nestedRowCheckbox}\n          />\n          <Space layout=\"inline\" h={2} />\n        </>\n      )}\n\n      <EntryIcon entry={entry} isOpen={isOpen} />\n      <Space layout=\"inline\" h={1} />\n\n      <label htmlFor={checkboxId} className={cx(styles.entryContentItem, styles.truncated)}>\n        {entry.name}\n      </label>\n    </div>\n  );\n};\n","import { cx } from '@emotion/css';\nimport { FadeTransition, LoadingPlaceholder, useStyles2 } from '@grafana/ui';\nimport React, { useEffect, useState } from 'react';\n\nimport { NestedEntry } from './NestedEntry';\nimport NestedRows from './NestedRows';\nimport getStyles from './styles';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from './types';\nimport { findRow } from './utils';\n\ninterface NestedRowProps {\n  row: ResourceRow;\n  level: number;\n  selectedRows: ResourceRowGroup;\n  requestNestedRows: (row: ResourceRow) => Promise<void>;\n  onRowSelectedChange: (row: ResourceRow, selected: boolean) => void;\n  selectableEntryTypes: ResourceRowType[];\n}\n\nconst NestedRow: React.FC<NestedRowProps> = ({\n  row,\n  selectedRows,\n  level,\n  requestNestedRows,\n  onRowSelectedChange,\n  selectableEntryTypes,\n}) => {\n  const styles = useStyles2(getStyles);\n  const [rowStatus, setRowStatus] = useState<'open' | 'closed' | 'loading'>('closed');\n\n  const isSelected = !!selectedRows.find((v) => v.id === row.id);\n  const isDisabled = selectedRows.length > 0 && !isSelected;\n  const isOpen = rowStatus === 'open';\n\n  const onRowToggleCollapse = async () => {\n    if (rowStatus === 'open') {\n      setRowStatus('closed');\n      return;\n    }\n    setRowStatus('loading');\n    requestNestedRows(row)\n      .then(() => setRowStatus('open'))\n      .catch(() => setRowStatus('closed'));\n  };\n\n  // opens the resource group on load of component if there was a previously saved selection\n  useEffect(() => {\n    // Assuming we don't have multi-select yet\n    const selectedRow = selectedRows[0];\n\n    const containsChild = selectedRow && !!findRow(row.children ?? [], selectedRow.id);\n\n    if (containsChild) {\n      setRowStatus('open');\n    }\n  }, [selectedRows, row]);\n\n  return (\n    <>\n      <tr className={cx(styles.row, isDisabled && styles.disabledRow)} key={row.id}>\n        <td className={styles.cell}>\n          <NestedEntry\n            level={level}\n            isSelected={isSelected}\n            isDisabled={isDisabled}\n            isOpen={isOpen}\n            entry={row}\n            onToggleCollapse={onRowToggleCollapse}\n            onSelectedChange={onRowSelectedChange}\n            isSelectable={selectableEntryTypes.some((type) => type === row.type)}\n          />\n        </td>\n\n        <td className={styles.cell}>{row.typeLabel}</td>\n\n        <td className={styles.cell}>{row.location ?? '-'}</td>\n      </tr>\n\n      {isOpen && row.children && Object.keys(row.children).length > 0 && (\n        <NestedRows\n          rows={row.children}\n          selectedRows={selectedRows}\n          level={level + 1}\n          requestNestedRows={requestNestedRows}\n          onRowSelectedChange={onRowSelectedChange}\n          selectableEntryTypes={selectableEntryTypes}\n        />\n      )}\n\n      <FadeTransition visible={rowStatus === 'loading'}>\n        <tr>\n          <td className={cx(styles.cell, styles.loadingCell)} colSpan={3}>\n            <LoadingPlaceholder text=\"Loading...\" className={styles.spinner} />\n          </td>\n        </tr>\n      </FadeTransition>\n    </>\n  );\n};\n\nexport default NestedRow;\n","import React from 'react';\nimport NestedRow from './NestedRow';\n\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from './types';\n\ninterface NestedRowsProps {\n  rows: ResourceRowGroup;\n  level: number;\n  selectedRows: ResourceRowGroup;\n  requestNestedRows: (row: ResourceRow) => Promise<void>;\n  onRowSelectedChange: (row: ResourceRow, selected: boolean) => void;\n  selectableEntryTypes: ResourceRowType[];\n}\n\nconst NestedRows: React.FC<NestedRowsProps> = ({\n  rows,\n  selectedRows,\n  level,\n  requestNestedRows,\n  onRowSelectedChange,\n  selectableEntryTypes,\n}) => (\n  <>\n    {rows.map((row) => (\n      <NestedRow\n        key={row.id}\n        row={row}\n        selectedRows={selectedRows}\n        level={level}\n        requestNestedRows={requestNestedRows}\n        onRowSelectedChange={onRowSelectedChange}\n        selectableEntryTypes={selectableEntryTypes}\n      />\n    ))}\n  </>\n);\n\nexport default NestedRows;\n","import React from 'react';\nimport { cx } from '@emotion/css';\n\nimport { useStyles2 } from '@grafana/ui';\n\nimport NestedRows from './NestedRows';\nimport getStyles from './styles';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from './types';\n\ninterface NestedResourceTableProps {\n  rows: ResourceRowGroup;\n  selectedRows: ResourceRowGroup;\n  noHeader?: boolean;\n  requestNestedRows: (row: ResourceRow) => Promise<void>;\n  onRowSelectedChange: (row: ResourceRow, selected: boolean) => void;\n  selectableEntryTypes: ResourceRowType[];\n}\n\nconst NestedResourceTable: React.FC<NestedResourceTableProps> = ({\n  rows,\n  selectedRows,\n  noHeader,\n  requestNestedRows,\n  onRowSelectedChange,\n  selectableEntryTypes,\n}) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <>\n      <table className={styles.table}>\n        {!noHeader && (\n          <thead>\n            <tr className={cx(styles.row, styles.header)}>\n              <td className={styles.cell}>Scope</td>\n              <td className={styles.cell}>Type</td>\n              <td className={styles.cell}>Location</td>\n            </tr>\n          </thead>\n        )}\n      </table>\n\n      <div className={styles.tableScroller}>\n        <table className={styles.table}>\n          <tbody>\n            <NestedRows\n              rows={rows}\n              selectedRows={selectedRows}\n              level={0}\n              requestNestedRows={requestNestedRows}\n              onRowSelectedChange={onRowSelectedChange}\n              selectableEntryTypes={selectableEntryTypes}\n            />\n          </tbody>\n        </table>\n      </div>\n    </>\n  );\n};\n\nexport default NestedResourceTable;\n","import { css } from '@emotion/css';\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Alert, Button, Icon, Input, LoadingPlaceholder, Tooltip, useStyles2, Collapse, Label } from '@grafana/ui';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport ResourcePickerData from '../../resourcePicker/resourcePickerData';\nimport messageFromError from '../../utils/messageFromError';\nimport { Space } from '../Space';\nimport NestedResourceTable from './NestedResourceTable';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from './types';\nimport { addResources, findRow, parseResourceURI } from './utils';\n\ninterface ResourcePickerProps {\n  resourcePickerData: ResourcePickerData;\n  resourceURI: string | undefined;\n  selectableEntryTypes: ResourceRowType[];\n\n  onApply: (resourceURI: string | undefined) => void;\n  onCancel: () => void;\n}\n\nconst ResourcePicker = ({\n  resourcePickerData,\n  resourceURI,\n  onApply,\n  onCancel,\n  selectableEntryTypes,\n}: ResourcePickerProps) => {\n  const styles = useStyles2(getStyles);\n\n  type LoadingStatus = 'NotStarted' | 'Started' | 'Done';\n  const [loadingStatus, setLoadingStatus] = useState<LoadingStatus>('NotStarted');\n  const [azureRows, setAzureRows] = useState<ResourceRowGroup>([]);\n  const [internalSelectedURI, setInternalSelectedURI] = useState<string | undefined>(resourceURI);\n  const [errorMessage, setErrorMessage] = useState<string | undefined>(undefined);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(resourceURI?.includes('$'));\n  // Sync the resourceURI prop to internal state\n  useEffect(() => {\n    setInternalSelectedURI(resourceURI);\n  }, [resourceURI]);\n\n  // Request initial data on first mount\n  useEffect(() => {\n    if (loadingStatus === 'NotStarted') {\n      const loadInitialData = async () => {\n        try {\n          setLoadingStatus('Started');\n          let resources = await resourcePickerData.getSubscriptions();\n          if (!internalSelectedURI) {\n            setAzureRows(resources);\n            setLoadingStatus('Done');\n            return;\n          }\n\n          const parsedURI = parseResourceURI(internalSelectedURI ?? '');\n          if (parsedURI) {\n            const resourceGroupURI = `/subscriptions/${parsedURI.subscriptionID}/resourceGroups/${parsedURI.resourceGroup}`;\n\n            // if a resource group was previously selected, but the resource groups under the parent subscription have not been loaded yet\n            if (parsedURI.resourceGroup && !findRow(resources, resourceGroupURI)) {\n              const resourceGroups = await resourcePickerData.getResourceGroupsBySubscriptionId(\n                parsedURI.subscriptionID\n              );\n              resources = addResources(resources, `/subscriptions/${parsedURI.subscriptionID}`, resourceGroups);\n            }\n\n            // if a resource was previously selected, but the resources under the parent resource group have not been loaded yet\n            if (parsedURI.resource && !findRow(azureRows, parsedURI.resource ?? '')) {\n              const resourcesForResourceGroup = await resourcePickerData.getResourcesForResourceGroup(resourceGroupURI);\n              resources = addResources(resources, resourceGroupURI, resourcesForResourceGroup);\n            }\n          }\n          setAzureRows(resources);\n          setLoadingStatus('Done');\n        } catch (error) {\n          setLoadingStatus('Done');\n          setErrorMessage(messageFromError(error));\n        }\n      };\n\n      loadInitialData();\n    }\n  }, [resourcePickerData, internalSelectedURI, azureRows, loadingStatus]);\n\n  // Map the selected item into an array of rows\n  const selectedResourceRows = useMemo(() => {\n    const found = internalSelectedURI && findRow(azureRows, internalSelectedURI);\n\n    return found\n      ? [\n          {\n            ...found,\n            children: undefined,\n          },\n        ]\n      : [];\n  }, [internalSelectedURI, azureRows]);\n\n  // Request resources for a expanded resource group\n  const requestNestedRows = useCallback(\n    async (resourceGroupOrSubscription: ResourceRow) => {\n      // clear error message (also when loading cached resources)\n      setErrorMessage(undefined);\n\n      // If we already have children, we don't need to re-fetch them.\n      if (resourceGroupOrSubscription.children?.length) {\n        return;\n      }\n\n      try {\n        const rows =\n          resourceGroupOrSubscription.type === ResourceRowType.Subscription\n            ? await resourcePickerData.getResourceGroupsBySubscriptionId(resourceGroupOrSubscription.id)\n            : await resourcePickerData.getResourcesForResourceGroup(resourceGroupOrSubscription.id);\n\n        const newRows = addResources(azureRows, resourceGroupOrSubscription.uri, rows);\n\n        setAzureRows(newRows);\n      } catch (error) {\n        setErrorMessage(messageFromError(error));\n        throw error;\n      }\n    },\n    [resourcePickerData, azureRows]\n  );\n\n  const handleSelectionChanged = useCallback((row: ResourceRow, isSelected: boolean) => {\n    isSelected ? setInternalSelectedURI(row.uri) : setInternalSelectedURI(undefined);\n  }, []);\n\n  const handleApply = useCallback(() => {\n    onApply(internalSelectedURI);\n  }, [internalSelectedURI, onApply]);\n\n  return (\n    <div>\n      {loadingStatus === 'Started' ? (\n        <div className={styles.loadingWrapper}>\n          <LoadingPlaceholder text={'Loading...'} />\n        </div>\n      ) : (\n        <>\n          <NestedResourceTable\n            rows={azureRows}\n            requestNestedRows={requestNestedRows}\n            onRowSelectedChange={handleSelectionChanged}\n            selectedRows={selectedResourceRows}\n            selectableEntryTypes={selectableEntryTypes}\n          />\n\n          <div className={styles.selectionFooter}>\n            {selectedResourceRows.length > 0 && (\n              <>\n                <h5>Selection</h5>\n                <NestedResourceTable\n                  rows={selectedResourceRows}\n                  requestNestedRows={requestNestedRows}\n                  onRowSelectedChange={handleSelectionChanged}\n                  selectedRows={selectedResourceRows}\n                  noHeader={true}\n                  selectableEntryTypes={selectableEntryTypes}\n                />\n                <Space v={2} />\n              </>\n            )}\n            <Collapse\n              collapsible\n              label=\"Advanced\"\n              isOpen={isAdvancedOpen}\n              onToggle={() => setIsAdvancedOpen(!isAdvancedOpen)}\n            >\n              <Label htmlFor={`input-${internalSelectedURI}`}>\n                <h6>\n                  Resource URI{' '}\n                  <Tooltip\n                    content={\n                      <>\n                        Manually edit the{' '}\n                        <a\n                          href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/logs/log-standard-columns#_resourceid\"\n                          rel=\"noopener noreferrer\"\n                          target=\"_blank\"\n                        >\n                          resource uri.{' '}\n                        </a>\n                        Supports the use of multiple template variables (ex: /subscriptions/$subId/resourceGroups/$rg)\n                      </>\n                    }\n                    placement=\"right\"\n                    interactive={true}\n                  >\n                    <Icon name=\"info-circle\" />\n                  </Tooltip>\n                </h6>\n              </Label>\n              <Input\n                id={`input-${internalSelectedURI}`}\n                value={internalSelectedURI}\n                onChange={(event) => setInternalSelectedURI(event.currentTarget.value)}\n                placeholder=\"ex: /subscriptions/$subId\"\n              />\n            </Collapse>\n            <Space v={2} />\n\n            <Button disabled={!!errorMessage} onClick={handleApply}>\n              Apply\n            </Button>\n\n            <Space layout=\"inline\" h={1} />\n\n            <Button onClick={onCancel} variant=\"secondary\">\n              Cancel\n            </Button>\n          </div>\n        </>\n      )}\n      {errorMessage && (\n        <>\n          <Space v={2} />\n          <Alert severity=\"error\" title=\"An error occurred while requesting resources from Azure Monitor\">\n            {errorMessage}\n          </Alert>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default ResourcePicker;\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  selectionFooter: css({\n    position: 'sticky',\n    bottom: 0,\n    background: theme.colors.background.primary,\n    paddingTop: theme.spacing(2),\n  }),\n  loadingWrapper: css({\n    textAlign: 'center',\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2),\n    color: theme.colors.text.secondary,\n  }),\n});\n","import { css } from '@emotion/css';\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, Icon, Modal, useStyles2 } from '@grafana/ui';\nimport React, { useCallback, useEffect, useState } from 'react';\n\nimport Datasource from '../../datasource';\nimport { AzureQueryEditorFieldProps, AzureResourceSummaryItem } from '../../types';\nimport { Field } from '../Field';\nimport ResourcePicker from '../ResourcePicker';\nimport { ResourceRowType } from '../ResourcePicker/types';\nimport { parseResourceURI } from '../ResourcePicker/utils';\nimport { Space } from '../Space';\nimport { setResource } from './setQueryValue';\n\nfunction parseResourceDetails(resourceURI: string) {\n  const parsed = parseResourceURI(resourceURI);\n\n  if (!parsed) {\n    return undefined;\n  }\n\n  return {\n    subscriptionName: parsed.subscriptionID,\n    resourceGroupName: parsed.resourceGroup,\n    resourceName: parsed.resource,\n  };\n}\n\nconst ResourceField: React.FC<AzureQueryEditorFieldProps> = ({ query, datasource, onQueryChange }) => {\n  const styles = useStyles2(getStyles);\n  const { resource } = query.azureLogAnalytics ?? {};\n  const [pickerIsOpen, setPickerIsOpen] = useState(false);\n\n  const handleOpenPicker = useCallback(() => {\n    setPickerIsOpen(true);\n  }, []);\n\n  const closePicker = useCallback(() => {\n    setPickerIsOpen(false);\n  }, []);\n\n  const handleApply = useCallback(\n    (resourceURI: string | undefined) => {\n      onQueryChange(setResource(query, resourceURI));\n      closePicker();\n    },\n    [closePicker, onQueryChange, query]\n  );\n\n  return (\n    <>\n      <Modal\n        className={styles.modal}\n        title=\"Select a resource\"\n        isOpen={pickerIsOpen}\n        onDismiss={closePicker}\n        // The growing number of rows added to the modal causes a focus\n        // error in the modal, making it impossible to click on new elements\n        trapFocus={false}\n      >\n        <ResourcePicker\n          resourcePickerData={datasource.resourcePickerData}\n          resourceURI={resource}\n          onApply={handleApply}\n          onCancel={closePicker}\n          selectableEntryTypes={[\n            ResourceRowType.Subscription,\n            ResourceRowType.ResourceGroup,\n            ResourceRowType.Resource,\n            ResourceRowType.Variable,\n          ]}\n        />\n      </Modal>\n\n      <Field label=\"Resource\">\n        <Button variant=\"secondary\" onClick={handleOpenPicker} type=\"button\">\n          <ResourceLabel resource={resource} datasource={datasource} />\n        </Button>\n      </Field>\n    </>\n  );\n};\n\ninterface ResourceLabelProps {\n  resource: string | undefined;\n  datasource: Datasource;\n}\n\nconst ResourceLabel = ({ resource, datasource }: ResourceLabelProps) => {\n  const [resourceComponents, setResourceComponents] = useState(parseResourceDetails(resource ?? ''));\n\n  useEffect(() => {\n    if (resource && parseResourceDetails(resource)) {\n      datasource.resourcePickerData.getResourceURIDisplayProperties(resource).then(setResourceComponents);\n    } else {\n      setResourceComponents(undefined);\n    }\n  }, [datasource.resourcePickerData, resource]);\n\n  if (!resource) {\n    return <>Select a resource</>;\n  }\n\n  if (resourceComponents) {\n    return <FormattedResource resource={resourceComponents} />;\n  }\n\n  if (resource.startsWith('$')) {\n    return (\n      <span>\n        <Icon name=\"x\" /> {resource}\n      </span>\n    );\n  }\n\n  return <>{resource}</>;\n};\n\ninterface FormattedResourceProps {\n  resource: AzureResourceSummaryItem;\n}\n\nconst FormattedResource = ({ resource }: FormattedResourceProps) => {\n  return (\n    <span>\n      <Icon name=\"layer-group\" /> {resource.subscriptionName}\n      {resource.resourceGroupName && (\n        <>\n          <Separator />\n          <Icon name=\"folder\" /> {resource.resourceGroupName}\n        </>\n      )}\n      {resource.resourceName && (\n        <>\n          <Separator />\n          <Icon name=\"cube\" /> {resource.resourceName}\n        </>\n      )}\n    </span>\n  );\n};\n\nconst Separator = () => (\n  <>\n    <Space layout=\"inline\" h={2} />\n    {'/'}\n    <Space layout=\"inline\" h={2} />\n  </>\n);\n\nexport default ResourceField;\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  modal: css({\n    width: theme.breakpoints.values.lg,\n  }),\n});\n","import { useEffect, useState } from 'react';\nimport { AzureMonitorQuery } from '../../types';\nimport Datasource from '../../datasource';\nimport { isGUIDish } from '../ResourcePicker/utils';\n\nasync function migrateWorkspaceQueryToResourceQuery(\n  datasource: Datasource,\n  query: AzureMonitorQuery,\n  onChange: (newQuery: AzureMonitorQuery) => void\n) {\n  if (query.azureLogAnalytics?.workspace !== undefined && !query.azureLogAnalytics.resource) {\n    const isWorkspaceGUID = isGUIDish(query.azureLogAnalytics.workspace);\n    let resource: string;\n\n    if (isWorkspaceGUID) {\n      resource = await datasource.resourcePickerData.getResourceURIFromWorkspace(query.azureLogAnalytics.workspace);\n    } else {\n      // The value of workspace is probably a template variable so we just migrate it over as-is\n      resource = query.azureLogAnalytics.workspace;\n    }\n\n    const newQuery = {\n      ...query,\n      azureLogAnalytics: {\n        ...query.azureLogAnalytics,\n        resource: resource,\n        workspace: undefined,\n      },\n    };\n\n    delete newQuery.azureLogAnalytics.workspace;\n\n    onChange(newQuery);\n  }\n}\n\ninterface ErrorMessage {\n  title: string;\n  message: string;\n}\n\nexport default function useMigrations(\n  datasource: Datasource,\n  query: AzureMonitorQuery,\n  onChange: (newQuery: AzureMonitorQuery) => void\n) {\n  const [migrationError, setMigrationError] = useState<ErrorMessage>();\n\n  useEffect(() => {\n    migrateWorkspaceQueryToResourceQuery(datasource, query, onChange).catch((err) =>\n      setMigrationError({\n        title: 'Unable to migrate workspace as a resource',\n        message: err.message,\n      })\n    );\n  }, [datasource, query, onChange]);\n\n  return migrationError;\n}\n","import React from 'react';\nimport { AzureMonitorErrorish, AzureMonitorOption, AzureMonitorQuery } from '../../types';\nimport Datasource from '../../datasource';\nimport { Alert, InlineFieldRow } from '@grafana/ui';\nimport QueryField from './QueryField';\nimport FormatAsField from './FormatAsField';\nimport ResourceField from './ResourceField';\nimport useMigrations from './useMigrations';\n\ninterface LogsQueryEditorProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  subscriptionId?: string;\n  onChange: (newQuery: AzureMonitorQuery) => void;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n  hideFormatAs?: boolean;\n}\n\nconst LogsQueryEditor: React.FC<LogsQueryEditorProps> = ({\n  query,\n  datasource,\n  subscriptionId,\n  variableOptionGroup,\n  onChange,\n  setError,\n  hideFormatAs,\n}) => {\n  const migrationError = useMigrations(datasource, query, onChange);\n\n  return (\n    <div data-testid=\"azure-monitor-logs-query-editor\">\n      <InlineFieldRow>\n        <ResourceField\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n      </InlineFieldRow>\n\n      <QueryField\n        query={query}\n        datasource={datasource}\n        subscriptionId={subscriptionId}\n        variableOptionGroup={variableOptionGroup}\n        onQueryChange={onChange}\n        setError={setError}\n      />\n\n      {!hideFormatAs && (\n        <FormatAsField\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n      )}\n\n      {migrationError && <Alert title={migrationError.title}>{migrationError.message}</Alert>}\n    </div>\n  );\n};\n\nexport default LogsQueryEditor;\n","import { AzureMonitorQuery } from '../../types';\n\nexport function setKustoQuery(query: AzureMonitorQuery, kustoQuery: string): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      query: kustoQuery,\n    },\n  };\n}\n\nexport function setFormatAs(query: AzureMonitorQuery, formatAs: string): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      resultFormat: formatAs,\n    },\n  };\n}\n\nexport function setResource(query: AzureMonitorQuery, resourceURI: string | undefined): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      resource: resourceURI,\n    },\n  };\n}\n","import { AzureMetricDimension, AzureMonitorQuery } from '../../types';\n\nexport function setSubscriptionID(query: AzureMonitorQuery, subscriptionID: string): AzureMonitorQuery {\n  if (query.subscription === subscriptionID) {\n    return query;\n  }\n\n  return {\n    ...query,\n    subscription: subscriptionID,\n    azureMonitor: {\n      ...query.azureMonitor,\n      resourceGroup: undefined,\n      metricDefinition: undefined,\n      metricNamespace: undefined,\n      resourceName: undefined,\n      metricName: undefined,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n\nexport function setResourceGroup(query: AzureMonitorQuery, resourceGroup: string | undefined): AzureMonitorQuery {\n  if (query.azureMonitor?.resourceGroup === resourceGroup) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      resourceGroup: resourceGroup,\n      metricDefinition: undefined,\n      metricNamespace: undefined,\n      resourceName: undefined,\n      metricName: undefined,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n\n// In the query as \"metricDefinition\" for some reason\nexport function setResourceType(query: AzureMonitorQuery, resourceType: string | undefined): AzureMonitorQuery {\n  if (query.azureMonitor?.metricDefinition === resourceType) {\n    return query;\n  }\n\n  const newQuery = {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      metricDefinition: resourceType,\n      resourceName: undefined,\n      metricNamespace: undefined,\n      metricName: undefined,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n\n  return newQuery;\n}\n\nexport function setResourceName(query: AzureMonitorQuery, resourceName: string | undefined): AzureMonitorQuery {\n  if (query.azureMonitor?.resourceName === resourceName) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      resourceName: resourceName,\n      metricNamespace: undefined,\n      metricName: undefined,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n\nexport function setMetricNamespace(query: AzureMonitorQuery, metricNamespace: string | undefined): AzureMonitorQuery {\n  if (query.azureMonitor?.metricNamespace === metricNamespace) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      metricNamespace: metricNamespace,\n      metricName: undefined,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n\nexport function setMetricName(query: AzureMonitorQuery, metricName: string | undefined): AzureMonitorQuery {\n  if (query.azureMonitor?.metricName === metricName) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      metricName: metricName,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n\nexport function setAggregation(query: AzureMonitorQuery, aggregation: string): AzureMonitorQuery {\n  if (query.azureMonitor?.aggregation === aggregation) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      aggregation: aggregation,\n    },\n  };\n}\n\nexport function setTimeGrain(query: AzureMonitorQuery, timeGrain: string): AzureMonitorQuery {\n  if (query.azureMonitor?.timeGrain === timeGrain) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      timeGrain: timeGrain,\n    },\n  };\n}\n\nexport function setDimensionFilters(query: AzureMonitorQuery, dimensions: AzureMetricDimension[]): AzureMonitorQuery {\n  if (query.azureMonitor?.dimensionFilters === dimensions) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      dimensionFilters: dimensions,\n    },\n  };\n}\n\nexport function appendDimensionFilter(\n  query: AzureMonitorQuery,\n  dimension = '',\n  operator = 'eq',\n  filter = ''\n): AzureMonitorQuery {\n  const existingFilters = query.azureMonitor?.dimensionFilters ?? [];\n\n  return setDimensionFilters(query, [\n    ...existingFilters,\n    {\n      dimension,\n      operator,\n      filter,\n    },\n  ]);\n}\n\nexport function removeDimensionFilter(query: AzureMonitorQuery, indexToRemove: number): AzureMonitorQuery {\n  const existingFilters = query.azureMonitor?.dimensionFilters ?? [];\n  const newFilters = [...existingFilters];\n  newFilters.splice(indexToRemove, 1);\n  return setDimensionFilters(query, newFilters);\n}\n\nexport function setDimensionFilterValue<Key extends keyof AzureMetricDimension>(\n  query: AzureMonitorQuery,\n  index: number,\n  fieldName: Key,\n  value: AzureMetricDimension[Key]\n): AzureMonitorQuery {\n  const existingFilters = query.azureMonitor?.dimensionFilters ?? [];\n  const newFilters = [...existingFilters];\n  const newFilter = newFilters[index];\n  newFilter[fieldName] = value;\n  return setDimensionFilters(query, newFilters);\n}\n\nexport function setTop(query: AzureMonitorQuery, top: string): AzureMonitorQuery {\n  if (query.azureMonitor?.top === top) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      top: top,\n    },\n  };\n}\n\nexport function setLegendAlias(query: AzureMonitorQuery, alias: string): AzureMonitorQuery {\n  if (query.azureMonitor?.alias === alias) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      alias: alias,\n    },\n  };\n}\n","import React, { useCallback, useMemo } from 'react';\nimport { SelectableValue } from '@grafana/data';\nimport { Select, MultiSelect } from '@grafana/ui';\n\nimport { AzureMonitorQuery, AzureQueryEditorFieldProps, AzureMonitorOption, AzureQueryType } from '../types';\nimport { findOptions } from '../utils/common';\nimport { Field } from './Field';\n\ninterface SubscriptionFieldProps extends AzureQueryEditorFieldProps {\n  onQueryChange: (newQuery: AzureMonitorQuery) => void;\n  subscriptions: AzureMonitorOption[];\n  multiSelect?: boolean;\n}\n\nconst SubscriptionField: React.FC<SubscriptionFieldProps> = ({\n  query,\n  subscriptions,\n  variableOptionGroup,\n  onQueryChange,\n  multiSelect = false,\n}) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      let newQuery: AzureMonitorQuery = {\n        ...query,\n        subscription: change.value,\n      };\n\n      if (query.queryType === AzureQueryType.AzureMonitor) {\n        newQuery.azureMonitor = {\n          ...newQuery.azureMonitor,\n          resourceGroup: undefined,\n          metricDefinition: undefined,\n          metricNamespace: undefined,\n          resourceName: undefined,\n          metricName: undefined,\n          aggregation: undefined,\n          timeGrain: '',\n          dimensionFilters: [],\n        };\n      }\n\n      onQueryChange(newQuery);\n    },\n    [query, onQueryChange]\n  );\n\n  const onSubscriptionsChange = useCallback(\n    (change: Array<SelectableValue<string>>) => {\n      if (!change) {\n        return;\n      }\n\n      query.subscriptions = change.map((c) => c.value ?? '');\n\n      onQueryChange(query);\n    },\n    [query, onQueryChange]\n  );\n\n  const options = useMemo(() => [...subscriptions, variableOptionGroup], [subscriptions, variableOptionGroup]);\n\n  return multiSelect ? (\n    <Field label=\"Subscriptions\">\n      <MultiSelect\n        menuShouldPortal\n        isClearable\n        value={findOptions([...subscriptions, ...variableOptionGroup.options], query.subscriptions)}\n        inputId=\"azure-monitor-subscriptions-field\"\n        onChange={onSubscriptionsChange}\n        options={options}\n        width={38}\n      />\n    </Field>\n  ) : (\n    <Field label=\"Subscription\">\n      <Select\n        menuShouldPortal\n        value={query.subscription}\n        inputId=\"azure-monitor-subscriptions-field\"\n        onChange={handleChange}\n        options={options}\n        width={38}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default SubscriptionField;\n","import { CodeEditor } from '@grafana/ui';\nimport React, { useCallback } from 'react';\nimport { AzureQueryEditorFieldProps } from '../../types';\n\nconst QueryField: React.FC<AzureQueryEditorFieldProps> = ({ query, onQueryChange }) => {\n  const onChange = useCallback(\n    (newQuery: string) => {\n      onQueryChange({\n        ...query,\n        azureResourceGraph: {\n          ...query.azureResourceGraph,\n          query: newQuery,\n        },\n      });\n    },\n    [onQueryChange, query]\n  );\n\n  return (\n    <CodeEditor\n      value={query.azureResourceGraph?.query ?? ''}\n      language=\"kusto\"\n      height={200}\n      width={1000}\n      showMiniMap={false}\n      onBlur={onChange}\n      onSave={onChange}\n    />\n  );\n};\n\nexport default QueryField;\n","import React, { useEffect, useState, useRef } from 'react';\nimport { AzureMonitorErrorish, AzureMonitorOption, AzureMonitorQuery } from '../../types';\nimport Datasource from '../../datasource';\nimport { InlineFieldRow } from '@grafana/ui';\nimport SubscriptionField from '../SubscriptionField';\nimport QueryField from './QueryField';\n\ninterface LogsQueryEditorProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  subscriptionId?: string;\n  onChange: (newQuery: AzureMonitorQuery) => void;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\nconst ERROR_SOURCE = 'arg-subscriptions';\nconst ArgQueryEditor: React.FC<LogsQueryEditorProps> = ({\n  query,\n  datasource,\n  subscriptionId,\n  variableOptionGroup,\n  onChange,\n  setError,\n}) => {\n  const fetchedRef = useRef(false);\n  const [subscriptions, setSubscriptions] = useState<AzureMonitorOption[]>([]);\n\n  useEffect(() => {\n    if (fetchedRef.current) {\n      return;\n    }\n\n    fetchedRef.current = true;\n    datasource.azureMonitorDatasource\n      .getSubscriptions()\n      .then((results) => {\n        const fetchedSubscriptions = results.map((v) => ({ label: v.text, value: v.value, description: v.value }));\n        setSubscriptions(fetchedSubscriptions);\n        setError(ERROR_SOURCE, undefined);\n\n        if (!query.subscriptions?.length && fetchedSubscriptions?.length) {\n          onChange({\n            ...query,\n            subscriptions: [query.subscription ?? fetchedSubscriptions[0].value],\n          });\n        }\n      })\n      .catch((err) => setError(ERROR_SOURCE, err));\n  }, [datasource, onChange, query, setError]);\n\n  return (\n    <div data-testid=\"azure-monitor-logs-query-editor\">\n      <InlineFieldRow>\n        <SubscriptionField\n          multiSelect\n          subscriptions={subscriptions}\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n      </InlineFieldRow>\n\n      <QueryField\n        query={query}\n        datasource={datasource}\n        subscriptionId={subscriptionId}\n        variableOptionGroup={variableOptionGroup}\n        onQueryChange={onChange}\n        setError={setError}\n      />\n    </div>\n  );\n};\n\nexport default ArgQueryEditor;\n","import { Alert, Input } from '@grafana/ui';\nimport React from 'react';\n\nimport { Field } from '../../../Field';\nimport { DeprecatedAzureMonitorQuery } from '../../types';\n\nconst ReadOnlyTimeGrain = ({\n  timeGrainCount,\n  timeGrainType,\n  timeGrainUnit,\n}: {\n  timeGrainCount: string;\n  timeGrainType: string;\n  timeGrainUnit: string;\n}) => {\n  const timeFields = timeGrainType === 'specific' ? ['specific', timeGrainCount, timeGrainUnit] : [timeGrainType];\n\n  return (\n    <Field label=\"Timegrain\">\n      <>\n        {timeFields.map((timeField) => (\n          <Input value={timeField} disabled={true} onChange={() => {}} key={timeField} width={10} />\n        ))}\n      </>\n    </Field>\n  );\n};\n\nconst ApplicationInsightsEditor = ({ query }: { query: DeprecatedAzureMonitorQuery }) => {\n  const groupBy = query.appInsights?.dimension || [];\n\n  return (\n    <div data-testid=\"azure-monitor-application-insights-query-editor\">\n      <Field label=\"Metric\" disabled={true}>\n        <Input\n          value={query.appInsights?.metricName}\n          disabled={true}\n          onChange={() => {}}\n          id=\"azure-monitor-application-insights-metric\"\n        />\n      </Field>\n      <Field label=\"Aggregation\" disabled={true}>\n        <Input value={query.appInsights?.aggregation} disabled={true} onChange={() => {}} />\n      </Field>\n      {groupBy.length > 0 && (\n        <Field label=\"Group by\">\n          <>\n            {groupBy.map((dimension) => (\n              <Input value={dimension} disabled={true} onChange={() => {}} key={dimension} />\n            ))}\n          </>\n        </Field>\n      )}\n      <Field label=\"Filter\" disabled={true}>\n        <Input value={query.appInsights?.dimensionFilter} disabled={true} onChange={() => {}} />\n      </Field>\n      <ReadOnlyTimeGrain\n        timeGrainCount={query.appInsights?.timeGrainCount || ''}\n        timeGrainType={query.appInsights?.timeGrainType || 'auto'}\n        timeGrainUnit={query.appInsights?.timeGrainUnit || 'minute'}\n      />\n      <Field label=\"Legend format\" disabled={true}>\n        <Input placeholder=\"Alias patterns\" value={query.appInsights?.alias} onChange={() => {}} disabled={true} />\n      </Field>\n      <Alert severity=\"info\" title=\"Deprecated\">\n        Application Insights is deprecated and is now read only. Migrate your queries to Metrics to make changes.\n      </Alert>\n    </div>\n  );\n};\n\nexport default ApplicationInsightsEditor;\n","import { Alert, CodeEditor, Select } from '@grafana/ui';\nimport React from 'react';\n\nimport { AzureMonitorOption } from '../../../../types';\nimport { Field } from '../../../Field';\nimport { Space } from '../../../Space';\nimport { DeprecatedAzureMonitorQuery } from '../../types';\n\ninterface InsightsAnalyticsEditorProps {\n  query: DeprecatedAzureMonitorQuery;\n}\n\nconst FORMAT_OPTIONS: Array<AzureMonitorOption<string>> = [\n  { label: 'Time series', value: 'time_series' },\n  { label: 'Table', value: 'table' },\n];\n\nconst InsightsAnalyticsEditor: React.FC<InsightsAnalyticsEditorProps> = ({ query }) => {\n  return (\n    <div data-testid=\"azure-monitor-insights-analytics-query-editor\">\n      <CodeEditor\n        language=\"kusto\"\n        value={query.insightsAnalytics?.query ?? ''}\n        height={200}\n        width=\"100%\"\n        readOnly={true}\n        showMiniMap={false}\n      />\n\n      <Field label=\"Format as\">\n        <Select\n          menuShouldPortal\n          inputId=\"azure-monitor-logs-workspaces-field\"\n          value={query.insightsAnalytics?.resultFormat}\n          disabled={true}\n          options={FORMAT_OPTIONS}\n          onChange={() => {}}\n          width={38}\n        />\n      </Field>\n\n      <Space v={2} />\n\n      <Alert severity=\"info\" title=\"Deprecated\">\n        Insights Analytics is deprecated and is now read only. Migrate your queries to Logs to make changes.\n      </Alert>\n    </div>\n  );\n};\n\nexport default InsightsAnalyticsEditor;\n","import React, { useCallback, useMemo } from 'react';\nimport { Select } from '@grafana/ui';\nimport { SelectableValue } from '@grafana/data';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { setMetricNamespace } from './setQueryValue';\n\ninterface MetricNamespaceFieldProps extends AzureQueryEditorFieldProps {\n  metricNamespaces: AzureMonitorOption[];\n}\n\nconst MetricNamespaceField: React.FC<MetricNamespaceFieldProps> = ({\n  metricNamespaces,\n  query,\n  variableOptionGroup,\n  onQueryChange,\n}) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setMetricNamespace(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = useMemo(() => [...metricNamespaces, variableOptionGroup], [metricNamespaces, variableOptionGroup]);\n  const optionValues = metricNamespaces.map((m) => m.value).concat(variableOptionGroup.options.map((p) => p.value));\n  const value = query.azureMonitor?.metricNamespace;\n  if (value && !optionValues.includes(value)) {\n    options.push({ label: value, value });\n  }\n\n  return (\n    <Field label=\"Metric namespace\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-metrics-metric-namespace-field\"\n        value={query.azureMonitor?.metricNamespace}\n        onChange={handleChange}\n        options={options}\n        width={38}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default MetricNamespaceField;\n","import React, { useCallback, useMemo } from 'react';\nimport { Select } from '@grafana/ui';\nimport { SelectableValue } from '@grafana/data';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { setResourceType } from './setQueryValue';\n\ninterface NamespaceFieldProps extends AzureQueryEditorFieldProps {\n  resourceTypes: AzureMonitorOption[];\n}\n\nconst NamespaceField: React.FC<NamespaceFieldProps> = ({\n  resourceTypes,\n  query,\n  variableOptionGroup,\n  onQueryChange,\n}) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setResourceType(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = useMemo(() => [...resourceTypes, variableOptionGroup], [resourceTypes, variableOptionGroup]);\n\n  return (\n    <Field label=\"Resource type\">\n      {/* It's expected that the label reads Resource type but the property is metricDefinition */}\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-metrics-resource-type-field\"\n        value={query.azureMonitor?.metricDefinition}\n        onChange={handleChange}\n        options={options}\n        width={38}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default NamespaceField;\n","import React, { useCallback, useMemo } from 'react';\nimport { Select } from '@grafana/ui';\nimport { SelectableValue } from '@grafana/data';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { setResourceGroup } from './setQueryValue';\n\ninterface ResourceGroupsFieldProps extends AzureQueryEditorFieldProps {\n  resourceGroups: AzureMonitorOption[];\n}\n\nconst ResourceGroupsField: React.FC<ResourceGroupsFieldProps> = ({\n  query,\n  resourceGroups,\n  variableOptionGroup,\n  onQueryChange,\n  setError,\n}) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      const newQuery = setResourceGroup(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = useMemo(() => [...resourceGroups, variableOptionGroup], [resourceGroups, variableOptionGroup]);\n\n  return (\n    <Field label=\"Resource group\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-metrics-resource-group-field\"\n        value={query.azureMonitor?.resourceGroup}\n        onChange={handleChange}\n        options={options}\n        width={38}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default ResourceGroupsField;\n","import React, { useCallback, useMemo } from 'react';\nimport { Select } from '@grafana/ui';\nimport { SelectableValue } from '@grafana/data';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { setResourceName } from './setQueryValue';\n\ninterface ResourceNameFieldProps extends AzureQueryEditorFieldProps {\n  resourceNames: AzureMonitorOption[];\n}\n\nconst ResourceNameField: React.FC<ResourceNameFieldProps> = ({\n  resourceNames,\n  query,\n  variableOptionGroup,\n  onQueryChange,\n}) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      const newQuery = setResourceName(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = useMemo(() => [...resourceNames, variableOptionGroup], [resourceNames, variableOptionGroup]);\n  const value = query.azureMonitor?.resourceName ?? null;\n\n  return (\n    <Field label=\"Resource name\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-metrics-resource-name-field\"\n        value={value}\n        onChange={handleChange}\n        options={options}\n        width={38}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default ResourceNameField;\n","import React, { useCallback, useMemo } from 'react';\nimport { Select } from '@grafana/ui';\nimport { SelectableValue } from '@grafana/data';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { setMetricName } from './setQueryValue';\n\ninterface MetricNameProps extends AzureQueryEditorFieldProps {\n  metricNames: AzureMonitorOption[];\n}\n\nconst MetricNameField: React.FC<MetricNameProps> = ({ metricNames, query, variableOptionGroup, onQueryChange }) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setMetricName(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = useMemo(() => [...metricNames, variableOptionGroup], [metricNames, variableOptionGroup]);\n\n  return (\n    <Field label=\"Metric\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-metrics-metric-field\"\n        value={query.azureMonitor?.metricName ?? null}\n        onChange={handleChange}\n        options={options}\n        width={38}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default MetricNameField;\n","import React, { useCallback, useMemo } from 'react';\nimport { Select } from '@grafana/ui';\nimport { SelectableValue } from '@grafana/data';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { setAggregation } from './setQueryValue';\n\ninterface AggregationFieldProps extends AzureQueryEditorFieldProps {\n  aggregationOptions: AzureMonitorOption[];\n  isLoading: boolean;\n}\n\nconst AggregationField: React.FC<AggregationFieldProps> = ({\n  query,\n  variableOptionGroup,\n  onQueryChange,\n  aggregationOptions,\n  isLoading,\n}) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setAggregation(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = useMemo(\n    () => [...aggregationOptions, variableOptionGroup],\n    [aggregationOptions, variableOptionGroup]\n  );\n\n  return (\n    <Field label=\"Aggregation\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-metrics-aggregation-field\"\n        value={query.azureMonitor?.aggregation}\n        onChange={handleChange}\n        options={options}\n        width={38}\n        isLoading={isLoading}\n      />\n    </Field>\n  );\n};\n\nexport default AggregationField;\n","import React, { useCallback, useMemo } from 'react';\nimport { Select } from '@grafana/ui';\nimport { SelectableValue } from '@grafana/data';\n\nimport { Field } from '../Field';\nimport TimegrainConverter from '../../time_grain_converter';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { setTimeGrain } from './setQueryValue';\n\ninterface TimeGrainFieldProps extends AzureQueryEditorFieldProps {\n  timeGrainOptions: AzureMonitorOption[];\n}\n\nconst TimeGrainField: React.FC<TimeGrainFieldProps> = ({\n  query,\n  timeGrainOptions,\n  variableOptionGroup,\n  onQueryChange,\n}) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setTimeGrain(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const timeGrains = useMemo(() => {\n    const autoInterval = TimegrainConverter.findClosestTimeGrain(\n      '1m',\n      timeGrainOptions.map((o) => TimegrainConverter.createKbnUnitFromISO8601Duration(o.value)) || [\n        '1m',\n        '5m',\n        '15m',\n        '30m',\n        '1h',\n        '6h',\n        '12h',\n        '1d',\n      ]\n    );\n\n    const baseTimeGrains = timeGrainOptions.map((v) => (v.value === 'auto' ? { ...v, description: autoInterval } : v));\n\n    return [...baseTimeGrains, variableOptionGroup];\n  }, [timeGrainOptions, variableOptionGroup]);\n\n  return (\n    <Field label=\"Time grain\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-metrics-time-grain-field\"\n        value={query.azureMonitor?.timeGrain}\n        onChange={handleChange}\n        options={timeGrains}\n        width={38}\n      />\n    </Field>\n  );\n};\n\nexport default TimeGrainField;\n","import React, { useMemo } from 'react';\nimport { Button, Select, Input, HorizontalGroup, VerticalGroup, InlineLabel } from '@grafana/ui';\n\nimport { Field } from '../Field';\nimport { AzureMetricDimension, AzureMonitorOption, AzureQueryEditorFieldProps } from '../../types';\nimport { appendDimensionFilter, removeDimensionFilter, setDimensionFilterValue } from './setQueryValue';\n\ninterface DimensionFieldsProps extends AzureQueryEditorFieldProps {\n  dimensionOptions: AzureMonitorOption[];\n}\n\nconst DimensionFields: React.FC<DimensionFieldsProps> = ({ query, dimensionOptions, onQueryChange }) => {\n  const dimensionFilters = useMemo(\n    () => query.azureMonitor?.dimensionFilters ?? [],\n    [query.azureMonitor?.dimensionFilters]\n  );\n\n  const addFilter = () => {\n    onQueryChange(appendDimensionFilter(query));\n  };\n\n  const removeFilter = (index: number) => {\n    onQueryChange(removeDimensionFilter(query, index));\n  };\n\n  const onFieldChange = <Key extends keyof AzureMetricDimension>(\n    filterIndex: number,\n    fieldName: Key,\n    value: AzureMetricDimension[Key]\n  ) => {\n    onQueryChange(setDimensionFilterValue(query, filterIndex, fieldName, value));\n  };\n\n  const onFilterInputChange = (index: number, ev: React.FormEvent) => {\n    if (ev.target instanceof HTMLInputElement) {\n      onFieldChange(index, 'filter', ev.target.value);\n    }\n  };\n\n  return (\n    <Field label=\"Dimension\">\n      <VerticalGroup spacing=\"xs\">\n        {dimensionFilters.map((filter, index) => (\n          <HorizontalGroup key={index} spacing=\"xs\">\n            <Select\n              menuShouldPortal\n              placeholder=\"Field\"\n              value={filter.dimension}\n              options={dimensionOptions}\n              onChange={(v) => onFieldChange(index, 'dimension', v.value ?? '')}\n              width={38}\n            />\n            <InlineLabel aria-label=\"equals\">==</InlineLabel>\n            <Input placeholder=\"\" value={filter.filter} onChange={(ev) => onFilterInputChange(index, ev)} />\n            <Button\n              variant=\"secondary\"\n              size=\"md\"\n              icon=\"trash-alt\"\n              aria-label=\"Remove\"\n              onClick={() => removeFilter(index)}\n            ></Button>\n          </HorizontalGroup>\n        ))}\n\n        <Button variant=\"secondary\" size=\"md\" onClick={addFilter}>\n          Add new dimension\n        </Button>\n      </VerticalGroup>\n    </Field>\n  );\n};\n\nexport default DimensionFields;\n","import React, { useCallback, useState } from 'react';\nimport { Input } from '@grafana/ui';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps } from '../../types';\nimport { setTop } from './setQueryValue';\n\nconst TopField: React.FC<AzureQueryEditorFieldProps> = ({ onQueryChange, query }) => {\n  const [value, setValue] = useState<string>(query.azureMonitor?.top ?? '');\n\n  // As calling onQueryChange initiates a the datasource refresh, we only want to call it once\n  // the field loses focus\n  const handleChange = useCallback((ev: React.FormEvent) => {\n    if (ev.target instanceof HTMLInputElement) {\n      setValue(ev.target.value);\n    }\n  }, []);\n\n  const handleBlur = useCallback(() => {\n    const newQuery = setTop(query, value);\n    onQueryChange(newQuery);\n  }, [onQueryChange, query, value]);\n\n  return (\n    <Field label=\"Top\">\n      <Input\n        id=\"azure-monitor-metrics-top-field\"\n        value={value}\n        onChange={handleChange}\n        onBlur={handleBlur}\n        width={16}\n      />\n    </Field>\n  );\n};\n\nexport default TopField;\n","import React, { useCallback, useState } from 'react';\nimport { Input } from '@grafana/ui';\n\nimport { Field } from '../Field';\nimport { AzureQueryEditorFieldProps } from '../../types';\nimport { setLegendAlias } from './setQueryValue';\n\nconst LegendFormatField: React.FC<AzureQueryEditorFieldProps> = ({ onQueryChange, query }) => {\n  const [value, setValue] = useState<string>(query.azureMonitor?.alias ?? '');\n\n  // As calling onQueryChange initiates a the datasource refresh, we only want to call it once\n  // the field loses focus\n  const handleChange = useCallback((ev: React.FormEvent) => {\n    if (ev.target instanceof HTMLInputElement) {\n      setValue(ev.target.value);\n    }\n  }, []);\n\n  const handleBlur = useCallback(() => {\n    const newQuery = setLegendAlias(query, value);\n    onQueryChange(newQuery);\n  }, [onQueryChange, query, value]);\n\n  return (\n    <Field label=\"Legend format\">\n      <Input\n        id=\"azure-monitor-metrics-legend-field\"\n        placeholder=\"Alias patterns\"\n        value={value}\n        onChange={handleChange}\n        onBlur={handleBlur}\n        width={38}\n      />\n    </Field>\n  );\n};\n\nexport default LegendFormatField;\n","import { useEffect, useMemo, useState } from 'react';\n\nimport Datasource from '../../datasource';\nimport { AzureMonitorErrorish, AzureMonitorOption, AzureMonitorQuery } from '../../types';\nimport { hasOption, toOption } from '../../utils/common';\nimport { setMetricNamespace, setSubscriptionID } from './setQueryValue';\n\nexport interface MetricMetadata {\n  aggOptions: AzureMonitorOption[];\n  timeGrains: AzureMonitorOption[];\n  dimensions: AzureMonitorOption[];\n  isLoading: boolean;\n\n  // These two properties are only used within the hook, and not elsewhere\n  supportedAggTypes: string[];\n  primaryAggType: string | undefined;\n}\n\ntype SetErrorFn = (source: string, error: AzureMonitorErrorish | undefined) => void;\ntype OnChangeFn = (newQuery: AzureMonitorQuery) => void;\n\nexport type DataHook = (\n  query: AzureMonitorQuery,\n  datasource: Datasource,\n  onChange: OnChangeFn,\n  setError: SetErrorFn\n) => AzureMonitorOption[];\n\nexport function useAsyncState<T>(asyncFn: () => Promise<T>, setError: Function, dependencies: unknown[]) {\n  // Use the lazy initial state functionality of useState to assign a random ID to the API call\n  // to track where errors come from. See useLastError.\n  const [errorSource] = useState(() => Math.random());\n  const [value, setValue] = useState<T>();\n\n  const finalValue = useMemo(() => value ?? [], [value]);\n\n  useEffect(() => {\n    asyncFn()\n      .then((results) => {\n        setValue(results);\n        setError(errorSource, undefined);\n      })\n      .catch((err) => {\n        setError(errorSource, err);\n      });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n\n  return finalValue;\n}\n\nexport const updateSubscriptions = (\n  query: AzureMonitorQuery,\n  subscriptionOptions: AzureMonitorOption[],\n  onChange: OnChangeFn,\n  defaultSubscription?: string\n) => {\n  const { subscription } = query;\n\n  // Return early if subscriptions havent loaded, or if the query already has a subscription\n  if (\n    !subscriptionOptions.length ||\n    (subscription && (hasOption(subscriptionOptions, subscription) || subscription.includes('$')))\n  ) {\n    return;\n  }\n\n  const defaultSub = defaultSubscription || subscriptionOptions[0].value;\n\n  if (!subscription && defaultSub && hasOption(subscriptionOptions, defaultSub)) {\n    onChange(setSubscriptionID(query, defaultSub));\n  }\n\n  // Check if the current subscription is in the list of subscriptions\n  if (subscription && !hasOption(subscriptionOptions, subscription)) {\n    if (hasOption(subscriptionOptions, defaultSub)) {\n      // Use the default sub if is on theh list\n      onChange(setSubscriptionID(query, defaultSub));\n    } else {\n      // Neither the current subscription nor the defaultSub is on the list, remove it\n      onChange(setSubscriptionID(query, ''));\n    }\n  }\n};\n\nexport const useSubscriptions: DataHook = (query, datasource, onChange, setError) => {\n  const defaultSubscription = datasource.azureMonitorDatasource.defaultSubscriptionId;\n  const { subscription } = query;\n\n  const subscriptionOptions = useAsyncState(\n    async () => {\n      const results = await datasource.azureMonitorDatasource.getSubscriptions();\n      const options = formatOptions(results, subscription);\n\n      return options;\n    },\n    setError,\n    []\n  );\n\n  useEffect(() => {\n    updateSubscriptions(query, subscriptionOptions, onChange, defaultSubscription);\n  }, [subscriptionOptions, query, defaultSubscription, onChange]);\n\n  return subscriptionOptions;\n};\n\nexport const useResourceGroups: DataHook = (query, datasource, onChange, setError) => {\n  const { subscription } = query;\n  const { resourceGroup } = query.azureMonitor ?? {};\n\n  return useAsyncState(\n    async () => {\n      if (!subscription) {\n        return;\n      }\n\n      const results = await datasource.getResourceGroups(subscription);\n      const options = formatOptions(results, resourceGroup);\n\n      return options;\n    },\n    setError,\n    [subscription]\n  );\n};\n\nexport const useResourceTypes: DataHook = (query, datasource, onChange, setError) => {\n  const { subscription } = query;\n  const { resourceGroup, metricDefinition } = query.azureMonitor ?? {};\n\n  return useAsyncState(\n    async () => {\n      if (!(subscription && resourceGroup)) {\n        return;\n      }\n\n      const results = await datasource.getMetricDefinitions(subscription, resourceGroup);\n      const options = formatOptions(results, metricDefinition);\n\n      return options;\n    },\n    setError,\n    [subscription, resourceGroup]\n  );\n};\n\nexport const useResourceNames: DataHook = (query, datasource, onChange, setError) => {\n  const { subscription } = query;\n  const { resourceGroup, metricDefinition, resourceName } = query.azureMonitor ?? {};\n\n  return useAsyncState(\n    async () => {\n      if (!(subscription && resourceGroup && metricDefinition)) {\n        return;\n      }\n\n      const results = await datasource.getResourceNames(subscription, resourceGroup, metricDefinition);\n      const options = formatOptions(results, resourceName);\n\n      return options;\n    },\n    setError,\n    [subscription, resourceGroup, metricDefinition]\n  );\n};\n\nexport const useMetricNamespaces: DataHook = (query, datasource, onChange, setError) => {\n  const { subscription } = query;\n  const { resourceGroup, metricDefinition, resourceName, metricNamespace } = query.azureMonitor ?? {};\n\n  const metricNamespaces = useAsyncState(\n    async () => {\n      if (!(subscription && resourceGroup && metricDefinition && resourceName)) {\n        return;\n      }\n\n      const results = await datasource.getMetricNamespaces(subscription, resourceGroup, metricDefinition, resourceName);\n      const options = formatOptions(results, metricNamespace);\n\n      // Do some cleanup of the query state if need be\n      if (!metricNamespace && options.length) {\n        onChange(setMetricNamespace(query, options[0].value));\n      }\n\n      return options;\n    },\n    setError,\n    [subscription, resourceGroup, metricDefinition, resourceName]\n  );\n\n  return metricNamespaces;\n};\n\nexport const useMetricNames: DataHook = (query, datasource, onChange, setError) => {\n  const { subscription } = query;\n  const { resourceGroup, metricDefinition, resourceName, metricNamespace, metricName } = query.azureMonitor ?? {};\n\n  return useAsyncState(\n    async () => {\n      if (!(subscription && resourceGroup && metricDefinition && resourceName && metricNamespace)) {\n        return;\n      }\n\n      const results = await datasource.getMetricNames(\n        subscription,\n        resourceGroup,\n        metricDefinition,\n        resourceName,\n        metricNamespace\n      );\n\n      const options = formatOptions(results, metricName);\n\n      return options;\n    },\n    setError,\n    [subscription, resourceGroup, metricDefinition, resourceName, metricNamespace]\n  );\n};\n\nexport const useMetricMetadata = (query: AzureMonitorQuery, datasource: Datasource, onChange: OnChangeFn) => {\n  const [metricMetadata, setMetricMetadata] = useState<MetricMetadata>({\n    aggOptions: [],\n    timeGrains: [],\n    dimensions: [],\n    isLoading: false,\n    supportedAggTypes: [],\n    primaryAggType: undefined,\n  });\n\n  const { subscription } = query;\n  const { resourceGroup, metricDefinition, resourceName, metricNamespace, metricName, aggregation, timeGrain } =\n    query.azureMonitor ?? {};\n\n  // Fetch new metric metadata when the fields change\n  useEffect(() => {\n    if (!(subscription && resourceGroup && metricDefinition && resourceName && metricNamespace && metricName)) {\n      return;\n    }\n\n    datasource\n      .getMetricMetadata(subscription, resourceGroup, metricDefinition, resourceName, metricNamespace, metricName)\n      .then((metadata) => {\n        // TODO: Move the aggregationTypes and timeGrain defaults into `getMetricMetadata`\n        const aggregations = (metadata.supportedAggTypes || [metadata.primaryAggType]).map((v) => ({\n          label: v,\n          value: v,\n        }));\n\n        setMetricMetadata({\n          aggOptions: aggregations,\n          timeGrains: metadata.supportedTimeGrains,\n          dimensions: metadata.dimensions,\n          isLoading: false,\n          supportedAggTypes: metadata.supportedAggTypes ?? [],\n          primaryAggType: metadata.primaryAggType,\n        });\n      });\n  }, [datasource, subscription, resourceGroup, metricDefinition, resourceName, metricNamespace, metricName]);\n\n  // Update the query state in response to the meta data changing\n  useEffect(() => {\n    const newAggregation = aggregation || metricMetadata.primaryAggType;\n    const newTimeGrain = timeGrain || 'auto';\n\n    if (newAggregation !== aggregation || newTimeGrain !== timeGrain) {\n      onChange({\n        ...query,\n        azureMonitor: {\n          ...query.azureMonitor,\n          aggregation: newAggregation,\n          timeGrain: newTimeGrain,\n        },\n      });\n    }\n  }, [onChange, metricMetadata, aggregation, timeGrain, query]);\n\n  return metricMetadata;\n};\n\nfunction formatOptions(\n  rawResults: Array<{\n    text: string;\n    value: string;\n  }>,\n  selectedValue?: string\n) {\n  const options = rawResults.map(toOption);\n\n  // account for custom values that might have been set in json file like ones crafted with a template variable (ex: \"cloud-datasource-resource-$Environment\")\n  if (selectedValue && !options.find((option) => option.value === selectedValue)) {\n    options.push({ label: selectedValue, value: selectedValue });\n  }\n\n  return options;\n}\n","import React from 'react';\n\nimport Datasource from '../../datasource';\nimport { AzureMonitorQuery, AzureMonitorOption, AzureMonitorErrorish } from '../../types';\nimport SubscriptionField from '../SubscriptionField';\nimport MetricNamespaceField from './MetricNamespaceField';\nimport ResourceTypeField from './ResourceTypeField';\nimport ResourceGroupsField from './ResourceGroupsField';\nimport ResourceNameField from './ResourceNameField';\nimport MetricNameField from './MetricNameField';\nimport AggregationField from './AggregationField';\nimport TimeGrainField from './TimeGrainField';\nimport DimensionFields from './DimensionFields';\nimport TopField from './TopField';\nimport LegendFormatField from './LegendFormatField';\nimport { InlineFieldRow } from '@grafana/ui';\nimport {\n  useMetricNames,\n  useMetricNamespaces,\n  useResourceGroups,\n  useResourceNames,\n  useResourceTypes,\n  useSubscriptions,\n  useMetricMetadata,\n} from './dataHooks';\n\ninterface MetricsQueryEditorProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  subscriptionId?: string;\n  onChange: (newQuery: AzureMonitorQuery) => void;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\nconst MetricsQueryEditor: React.FC<MetricsQueryEditorProps> = ({\n  query,\n  datasource,\n  subscriptionId,\n  variableOptionGroup,\n  onChange,\n  setError,\n}) => {\n  const metricsMetadata = useMetricMetadata(query, datasource, onChange);\n  const subscriptions = useSubscriptions(query, datasource, onChange, setError);\n  const resourceGroups = useResourceGroups(query, datasource, onChange, setError);\n  const resourceTypes = useResourceTypes(query, datasource, onChange, setError);\n  const resourceNames = useResourceNames(query, datasource, onChange, setError);\n  const metricNames = useMetricNames(query, datasource, onChange, setError);\n  const metricNamespaces = useMetricNamespaces(query, datasource, onChange, setError);\n\n  return (\n    <div data-testid=\"azure-monitor-metrics-query-editor\">\n      <InlineFieldRow>\n        <SubscriptionField\n          subscriptions={subscriptions}\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n\n        <ResourceGroupsField\n          resourceGroups={resourceGroups}\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <ResourceTypeField\n          resourceTypes={resourceTypes}\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n        <ResourceNameField\n          resourceNames={resourceNames}\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n      </InlineFieldRow>\n\n      <InlineFieldRow>\n        <MetricNamespaceField\n          metricNamespaces={metricNamespaces}\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n        <MetricNameField\n          metricNames={metricNames}\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n        />\n      </InlineFieldRow>\n      <InlineFieldRow>\n        <AggregationField\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n          aggregationOptions={metricsMetadata?.aggOptions ?? []}\n          isLoading={metricsMetadata.isLoading}\n        />\n        <TimeGrainField\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n          timeGrainOptions={metricsMetadata?.timeGrains ?? []}\n        />\n      </InlineFieldRow>\n      <DimensionFields\n        query={query}\n        datasource={datasource}\n        subscriptionId={subscriptionId}\n        variableOptionGroup={variableOptionGroup}\n        onQueryChange={onChange}\n        setError={setError}\n        dimensionOptions={metricsMetadata?.dimensions ?? []}\n      />\n      <TopField\n        query={query}\n        datasource={datasource}\n        subscriptionId={subscriptionId}\n        variableOptionGroup={variableOptionGroup}\n        onQueryChange={onChange}\n        setError={setError}\n      />\n      <LegendFormatField\n        query={query}\n        datasource={datasource}\n        subscriptionId={subscriptionId}\n        variableOptionGroup={variableOptionGroup}\n        onQueryChange={onChange}\n        setError={setError}\n      />\n    </div>\n  );\n};\n\nexport default MetricsQueryEditor;\n","import React from 'react';\n\ninterface MetricsQueryEditorProps {}\n\nconst MetricsQueryEditor: React.FC<MetricsQueryEditorProps> = ({}) => {\n  return <div data-testid=\"azure-monitor-metrics-query-editor-with-resource-picker\">New Query Editor</div>;\n};\n\nexport default MetricsQueryEditor;\n","import { SelectableValue } from '@grafana/data';\nimport { Select } from '@grafana/ui';\nimport React, { useCallback, useState } from 'react';\n\nimport { AzureMonitorQuery, AzureQueryType, DeprecatedAzureQueryType } from '../../types';\nimport { gtGrafana9 } from '../deprecated/utils';\nimport { Field } from '../Field';\n\ninterface QueryTypeFieldProps {\n  query: AzureMonitorQuery;\n  onQueryChange: (newQuery: AzureMonitorQuery) => void;\n}\n\nconst QueryTypeField: React.FC<QueryTypeFieldProps> = ({ query, onQueryChange }) => {\n  // Use useState to capture the initial value on first mount. We're not interested in when it changes\n  // We only show App Insights and Insights Analytics if they were initially selected. Otherwise, hide them.\n  const [initialQueryType] = useState(query.queryType);\n\n  const queryTypes: Array<{ value: AzureQueryType | DeprecatedAzureQueryType; label: string }> = [\n    { value: AzureQueryType.AzureMonitor, label: 'Metrics' },\n    { value: AzureQueryType.LogAnalytics, label: 'Logs' },\n    { value: AzureQueryType.AzureResourceGraph, label: 'Azure Resource Graph' },\n  ];\n\n  if (\n    !gtGrafana9() &&\n    (initialQueryType === DeprecatedAzureQueryType.ApplicationInsights ||\n      initialQueryType === DeprecatedAzureQueryType.InsightsAnalytics)\n  ) {\n    queryTypes.push(\n      { value: DeprecatedAzureQueryType.ApplicationInsights, label: 'Application Insights' },\n      { value: DeprecatedAzureQueryType.InsightsAnalytics, label: 'Insights Analytics' }\n    );\n  }\n\n  const handleChange = useCallback(\n    (change: SelectableValue<AzureQueryType | DeprecatedAzureQueryType>) => {\n      change.value &&\n        onQueryChange({\n          ...query,\n          queryType: change.value,\n        });\n    },\n    [onQueryChange, query]\n  );\n\n  return (\n    <Field label=\"Service\">\n      <Select\n        menuShouldPortal\n        inputId=\"azure-monitor-query-type-field\"\n        value={query.queryType}\n        options={queryTypes}\n        onChange={handleChange}\n        width={38}\n      />\n    </Field>\n  );\n};\n\nexport default QueryTypeField;\n","import { useEffect, useMemo } from 'react';\nimport { defaults } from 'lodash';\nimport { AzureMonitorQuery, AzureQueryType } from '../../types';\nimport deepEqual from 'fast-deep-equal';\nimport migrateQuery from '../../utils/migrateQuery';\n\nconst DEFAULT_QUERY = {\n  queryType: AzureQueryType.AzureMonitor,\n};\n\nconst prepareQuery = (query: AzureMonitorQuery) => {\n  // Note: _.defaults does not apply default values deeply.\n  const withDefaults = defaults({}, query, DEFAULT_QUERY);\n  const migratedQuery = migrateQuery(withDefaults);\n\n  // If we didn't make any changes to the object, then return the original object to keep the\n  // identity the same, and not trigger any other useEffects or anything.\n  return deepEqual(migratedQuery, query) ? query : migratedQuery;\n};\n\n/**\n * Returns queries with some defaults + migrations, and calls onChange function to notify if it changes\n */\nconst usePreparedQuery = (query: AzureMonitorQuery, onChangeQuery: (newQuery: AzureMonitorQuery) => void) => {\n  const preparedQuery = useMemo(() => prepareQuery(query), [query]);\n\n  useEffect(() => {\n    if (preparedQuery !== query) {\n      onChangeQuery(preparedQuery);\n    }\n  }, [preparedQuery, query, onChangeQuery]);\n\n  return preparedQuery;\n};\n\nexport default usePreparedQuery;\n","import { QueryEditorProps } from '@grafana/data';\nimport { Alert } from '@grafana/ui';\nimport { config } from '@grafana/runtime';\n\nimport { debounce } from 'lodash';\nimport React, { useCallback, useMemo } from 'react';\n\nimport AzureMonitorDatasource from '../../datasource';\nimport {\n  AzureDataSourceJsonData,\n  AzureMonitorErrorish,\n  AzureMonitorOption,\n  AzureMonitorQuery,\n  AzureQueryType,\n  DeprecatedAzureQueryType,\n} from '../../types';\nimport useLastError from '../../utils/useLastError';\nimport ArgQueryEditor from '../ArgQueryEditor';\nimport ApplicationInsightsEditor from '../deprecated/components/ApplicationInsightsEditor';\nimport InsightsAnalyticsEditor from '../deprecated/components/InsightsAnalyticsEditor';\nimport { gtGrafana9 } from '../deprecated/utils';\nimport LogsQueryEditor from '../LogsQueryEditor';\nimport MetricsQueryEditor from '../MetricsQueryEditor';\nimport NewMetricsQueryEditor from '../NewMetricsQueryEditor/MetricsQueryEditor';\nimport { Space } from '../Space';\nimport QueryTypeField from './QueryTypeField';\nimport usePreparedQuery from './usePreparedQuery';\n\nexport type AzureMonitorQueryEditorProps = QueryEditorProps<\n  AzureMonitorDatasource,\n  AzureMonitorQuery,\n  AzureDataSourceJsonData\n>;\n\nconst QueryEditor: React.FC<AzureMonitorQueryEditorProps> = ({\n  query: baseQuery,\n  datasource,\n  onChange,\n  onRunQuery: baseOnRunQuery,\n}) => {\n  const [errorMessage, setError] = useLastError();\n  const onRunQuery = useMemo(() => debounce(baseOnRunQuery, 500), [baseOnRunQuery]);\n\n  const onQueryChange = useCallback(\n    (newQuery: AzureMonitorQuery) => {\n      onChange(newQuery);\n      onRunQuery();\n    },\n    [onChange, onRunQuery]\n  );\n\n  const query = usePreparedQuery(baseQuery, onQueryChange);\n\n  const subscriptionId = query.subscription || datasource.azureMonitorDatasource.defaultSubscriptionId;\n  const variableOptionGroup = {\n    label: 'Template Variables',\n    options: datasource.getVariables().map((v) => ({ label: v, value: v })),\n  };\n\n  return (\n    <div data-testid=\"azure-monitor-query-editor\">\n      <QueryTypeField query={query} onQueryChange={onQueryChange} />\n\n      <EditorForQueryType\n        subscriptionId={subscriptionId}\n        query={query}\n        datasource={datasource}\n        onChange={onQueryChange}\n        variableOptionGroup={variableOptionGroup}\n        setError={setError}\n      />\n\n      {errorMessage && (\n        <>\n          <Space v={2} />\n          <Alert severity=\"error\" title=\"An error occurred while requesting metadata from Azure Monitor\">\n            {errorMessage}\n          </Alert>\n        </>\n      )}\n    </div>\n  );\n};\n\ninterface EditorForQueryTypeProps extends Omit<AzureMonitorQueryEditorProps, 'onRunQuery'> {\n  subscriptionId?: string;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\nconst EditorForQueryType: React.FC<EditorForQueryTypeProps> = ({\n  subscriptionId,\n  query,\n  datasource,\n  variableOptionGroup,\n  onChange,\n  setError,\n}) => {\n  switch (query.queryType) {\n    case AzureQueryType.AzureMonitor:\n      if (config.featureToggles.azureMonitorResourcePickerForMetrics) {\n        return <NewMetricsQueryEditor />;\n      }\n      return (\n        <MetricsQueryEditor\n          subscriptionId={subscriptionId}\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          variableOptionGroup={variableOptionGroup}\n          setError={setError}\n        />\n      );\n\n    case AzureQueryType.LogAnalytics:\n      return (\n        <LogsQueryEditor\n          subscriptionId={subscriptionId}\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          variableOptionGroup={variableOptionGroup}\n          setError={setError}\n        />\n      );\n\n    case AzureQueryType.AzureResourceGraph:\n      return (\n        <ArgQueryEditor\n          subscriptionId={subscriptionId}\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          variableOptionGroup={variableOptionGroup}\n          setError={setError}\n        />\n      );\n\n    /** Remove with Grafana 9 */\n    case DeprecatedAzureQueryType.ApplicationInsights:\n      if (gtGrafana9()) {\n        return (\n          <Alert title=\"Deprecated\">\n            Application Insights has been deprecated.{' '}\n            <a\n              href=\"https://grafana.com/docs/grafana/latest/datasources/azuremonitor/deprecated-application-insights/#application-insights\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              Use the Metrics service instead\n            </a>\n            .\n          </Alert>\n        );\n      }\n      return <ApplicationInsightsEditor query={query} />;\n\n    case DeprecatedAzureQueryType.InsightsAnalytics:\n      if (gtGrafana9()) {\n        return (\n          <Alert title=\"Deprecated\">\n            Insight Analytics has been deprecated.{' '}\n            <a\n              href=\"https://grafana.com/docs/grafana/latest/datasources/azuremonitor/deprecated-application-insights/#insights-analytics\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              Queries can be written with Kusto in the Logs query type by selecting your Application Insights resource\n            </a>\n            .\n          </Alert>\n        );\n      }\n      return <InsightsAnalyticsEditor query={query} />;\n    /** ===================== */\n\n    default:\n      return <Alert title=\"Unknown query type\" />;\n  }\n\n  return null;\n};\n\nexport default QueryEditor;\n","export enum ResourceRowType {\n  Subscription = 'Subscription',\n  ResourceGroup = 'ResourceGroup',\n  Resource = 'Resource',\n  VariableGroup = 'TemplateVariableGroup',\n  Variable = 'TemplateVariable',\n}\n\nexport interface ResourceRow {\n  id: string; // azure's raw data id usually passes along a uri (except in the case of subscriptions), to make things less confusing for ourselves we parse the id string out of the uri or vice versa\n  uri: string; // ex: /subscriptions/subid123\n  name: string;\n  type: ResourceRowType;\n  typeLabel: string;\n  location?: string;\n  children?: ResourceRowGroup;\n}\n\nexport type ResourceRowGroup = ResourceRow[];\n","import produce from 'immer';\nimport { ResourceRow, ResourceRowGroup } from './types';\n\n// This regex matches URIs representing:\n//  - subscriptions: /subscriptions/44693801-6ee6-49de-9b2d-9106972f9572\n//  - resource groups: /subscriptions/44693801-6ee6-49de-9b2d-9106972f9572/resourceGroups/cloud-datasources\n//  - resources: /subscriptions/44693801-6ee6-49de-9b2d-9106972f9572/resourceGroups/cloud-datasources/providers/Microsoft.Compute/virtualMachines/GithubTestDataVM\nconst RESOURCE_URI_REGEX =\n  /\\/subscriptions\\/(?<subscriptionID>[^/]+)(?:\\/resourceGroups\\/(?<resourceGroup>[^/]+)(?:\\/providers.+\\/(?<resource>[^/]+))?)?/;\n\ntype RegexGroups = Record<string, string | undefined>;\n\nexport function parseResourceURI(resourceURI: string) {\n  const matches = RESOURCE_URI_REGEX.exec(resourceURI);\n  const groups: RegexGroups = matches?.groups ?? {};\n  const { subscriptionID, resourceGroup, resource } = groups;\n\n  if (!subscriptionID) {\n    return undefined;\n  }\n\n  return { subscriptionID, resourceGroup, resource };\n}\n\nexport function isGUIDish(input: string) {\n  return !!input.match(/^[A-Z0-9]+/i);\n}\n\nexport function findRow(rows: ResourceRowGroup, uri: string): ResourceRow | undefined {\n  for (const row of rows) {\n    if (row.uri.toLowerCase() === uri.toLowerCase()) {\n      return row;\n    }\n\n    if (row.children) {\n      const result = findRow(row.children, uri);\n\n      if (result) {\n        return result;\n      }\n    }\n  }\n\n  return undefined;\n}\n\nexport function addResources(rows: ResourceRowGroup, targetParentId: string, newResources: ResourceRowGroup) {\n  return produce(rows, (draftState) => {\n    const draftRow = findRow(draftState, targetParentId);\n\n    // we can't find the selected resource in our list of resources,\n    // probably means user has either mistyped in the input field\n    // or is using template variables.\n    // either way no need to throw, just show that none of the resources are checked\n    if (!draftRow) {\n      return;\n    }\n\n    draftRow.children = newResources;\n  });\n}\n","import React from 'react';\nimport { css, cx } from '@emotion/css';\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { stylesFactory, useTheme2 } from '@grafana/ui';\n\nexport interface SpaceProps {\n  v?: number;\n  h?: number;\n  layout?: 'block' | 'inline';\n}\n\nexport const Space = (props: SpaceProps) => {\n  const theme = useTheme2();\n  const styles = getStyles(theme, props);\n\n  return <span className={cx(styles.wrapper)} />;\n};\n\nSpace.defaultProps = {\n  v: 0,\n  h: 0,\n  layout: 'block',\n};\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2, props: SpaceProps) => ({\n  wrapper: css([\n    {\n      paddingRight: theme.spacing(props.h ?? 0),\n      paddingBottom: theme.spacing(props.v ?? 0),\n    },\n    props.layout === 'inline' && {\n      display: 'inline-block',\n    },\n    props.layout === 'block' && {\n      display: 'block',\n    },\n  ]),\n}));\n","import { config } from '@grafana/runtime';\nimport { gt, valid } from 'semver';\n\nimport { AzureDataSourceSettings } from '../../types';\n\nexport function isAppInsightsConfigured(options: AzureDataSourceSettings) {\n  return !!(options.jsonData.appInsightsAppId && options.secureJsonFields.appInsightsApiKey);\n}\n\nexport function gtGrafana9() {\n  // AppInsights configuration will be removed with Grafana 9\n  return valid(config.buildInfo.version) && gt(config.buildInfo.version, '9.0.0-beta1');\n}\n","import { includes, filter } from 'lodash';\nimport { rangeUtil } from '@grafana/data';\n\nexport default class TimeGrainConverter {\n  static createISO8601Duration(timeGrain: string | number, timeGrainUnit: any) {\n    const timeIntervals = ['hour', 'minute', 'h', 'm'];\n    if (includes(timeIntervals, timeGrainUnit)) {\n      return `PT${timeGrain}${timeGrainUnit[0].toUpperCase()}`;\n    }\n\n    return `P${timeGrain}${timeGrainUnit[0].toUpperCase()}`;\n  }\n\n  static createISO8601DurationFromInterval(interval: string) {\n    const timeGrain = +interval.slice(0, interval.length - 1);\n    const unit = interval[interval.length - 1];\n\n    if (interval.indexOf('ms') > -1) {\n      return TimeGrainConverter.createISO8601Duration(1, 'm');\n    }\n\n    if (interval[interval.length - 1] === 's') {\n      let toMinutes = (timeGrain * 60) % 60;\n\n      if (toMinutes < 1) {\n        toMinutes = 1;\n      }\n\n      return TimeGrainConverter.createISO8601Duration(toMinutes, 'm');\n    }\n\n    return TimeGrainConverter.createISO8601Duration(timeGrain, unit);\n  }\n\n  static findClosestTimeGrain(interval: any, allowedTimeGrains: string[]) {\n    const timeGrains = filter(allowedTimeGrains, (o) => o !== 'auto');\n\n    let closest = timeGrains[0];\n    const intervalMs = rangeUtil.intervalToMs(interval);\n\n    for (let i = 0; i < timeGrains.length; i++) {\n      // abs (num - val) < abs (num - curr):\n      if (intervalMs > rangeUtil.intervalToMs(timeGrains[i])) {\n        if (i + 1 < timeGrains.length) {\n          closest = timeGrains[i + 1];\n        } else {\n          closest = timeGrains[i];\n        }\n      }\n    }\n\n    return closest;\n  }\n\n  static createTimeGrainFromISO8601Duration(duration: string) {\n    let offset = 1;\n    if (duration.substring(0, 2) === 'PT') {\n      offset = 2;\n    }\n\n    const value = duration.substring(offset, duration.length - 1);\n    const unit = duration.substring(duration.length - 1);\n\n    return value + ' ' + TimeGrainConverter.timeUnitToText(+value, unit);\n  }\n\n  static timeUnitToText(value: number, unit: string) {\n    let text = '';\n\n    if (unit === 'S') {\n      text = 'second';\n    }\n    if (unit === 'M') {\n      text = 'minute';\n    }\n    if (unit === 'H') {\n      text = 'hour';\n    }\n    if (unit === 'D') {\n      text = 'day';\n    }\n\n    if (value > 1) {\n      return text + 's';\n    }\n\n    return text;\n  }\n\n  static createKbnUnitFromISO8601Duration(duration: string) {\n    if (duration === 'auto') {\n      return 'auto';\n    }\n\n    let offset = 1;\n    if (duration.substring(0, 2) === 'PT') {\n      offset = 2;\n    }\n\n    const value = duration.substring(offset, duration.length - 1);\n    const unit = duration.substring(duration.length - 1);\n\n    return value + TimeGrainConverter.timeUnitToKbn(+value, unit);\n  }\n\n  static timeUnitToKbn(value: number, unit: string) {\n    if (unit === 'S') {\n      return 's';\n    }\n    if (unit === 'M') {\n      return 'm';\n    }\n    if (unit === 'H') {\n      return 'h';\n    }\n    if (unit === 'D') {\n      return 'd';\n    }\n\n    return '';\n  }\n}\n","import { DeprecatedAzureMonitorQuery } from '../components/deprecated/types';\nimport { GrafanaTemplateVariableQuery } from './templateVariables';\n\nexport enum AzureQueryType {\n  AzureMonitor = 'Azure Monitor',\n  LogAnalytics = 'Azure Log Analytics',\n  AzureResourceGraph = 'Azure Resource Graph',\n  GrafanaTemplateVariableFn = 'Grafana Template Variable Function',\n}\n\n// DeprecatedAzureQueryType won't be available after Grafana 9\nexport enum DeprecatedAzureQueryType {\n  ApplicationInsights = 'Application Insights',\n  InsightsAnalytics = 'Insights Analytics',\n}\n\n/**\n * Represents the query as it moves through the frontend query editor and datasource files.\n * It can represent new queries that are still being edited, so all properties are optional\n */\nexport interface AzureMonitorQuery extends DeprecatedAzureMonitorQuery {\n  queryType?: AzureQueryType | DeprecatedAzureQueryType;\n\n  subscription?: string;\n\n  /** ARG uses multiple subscriptions */\n  subscriptions?: string[];\n\n  azureMonitor?: AzureMetricQuery;\n  azureLogAnalytics?: AzureLogsQuery;\n  azureResourceGraph?: AzureResourceGraphQuery;\n  grafanaTemplateVariableFn?: GrafanaTemplateVariableQuery;\n}\n\n/**\n * Azure Monitor Metrics sub-query properties\n */\nexport interface AzureMetricQuery {\n  resourceGroup?: string;\n\n  /** Resource type */\n  metricDefinition?: string;\n\n  resourceName?: string;\n  metricNamespace?: string;\n  metricName?: string;\n  timeGrain?: string;\n  aggregation?: string;\n  dimensionFilters?: AzureMetricDimension[];\n  alias?: string;\n  top?: string;\n\n  /** @deprecated */\n  timeGrainUnit?: string;\n\n  /** @deprecated Remove this once angular is removed */\n  allowedTimeGrainsMs?: number[];\n\n  /** @deprecated This property was migrated to dimensionFilters and should only be accessed in the migration */\n  dimension?: string;\n\n  /** @deprecated This property was migrated to dimensionFilters and should only be accessed in the migration */\n  dimensionFilter?: string;\n}\n\n/**\n * Azure Monitor Logs sub-query properties\n */\nexport interface AzureLogsQuery {\n  query?: string;\n  resultFormat?: string;\n  resource?: string;\n\n  workspace?: string;\n}\n\n/**\n * Azure Monitor ARG sub-query properties\n */\nexport interface AzureResourceGraphQuery {\n  query?: string;\n  resultFormat?: string;\n}\n\nexport interface AzureMetricDimension {\n  dimension: string;\n  operator: string;\n  filter?: string;\n}\n","import { DataSourceInstanceSettings, DataSourceJsonData, DataSourceSettings, TableData } from '@grafana/data';\n\nimport Datasource from '../datasource';\nimport { AzureMonitorQuery } from './query';\n\nexport type AzureDataSourceSettings = DataSourceSettings<AzureDataSourceJsonData, AzureDataSourceSecureJsonData>;\nexport type AzureDataSourceInstanceSettings = DataSourceInstanceSettings<AzureDataSourceJsonData>;\n\nexport interface DatasourceValidationResult {\n  status: 'success' | 'error';\n  message: string;\n  title?: string;\n}\n\n/**\n * Azure clouds known to Azure Monitor.\n */\nexport enum AzureCloud {\n  Public = 'AzureCloud',\n  China = 'AzureChinaCloud',\n  USGovernment = 'AzureUSGovernment',\n  Germany = 'AzureGermanCloud',\n  None = '',\n}\n\nexport type AzureAuthType = 'msi' | 'clientsecret';\n\nexport type ConcealedSecret = symbol;\n\ninterface AzureCredentialsBase {\n  authType: AzureAuthType;\n  defaultSubscriptionId?: string;\n}\n\nexport interface AzureManagedIdentityCredentials extends AzureCredentialsBase {\n  authType: 'msi';\n}\n\nexport interface AzureClientSecretCredentials extends AzureCredentialsBase {\n  authType: 'clientsecret';\n  azureCloud?: string;\n  tenantId?: string;\n  clientId?: string;\n  clientSecret?: string | ConcealedSecret;\n}\n\nexport type AzureCredentials = AzureManagedIdentityCredentials | AzureClientSecretCredentials;\n\nexport interface AzureDataSourceJsonData extends DataSourceJsonData {\n  cloudName: string;\n  azureAuthType?: AzureAuthType;\n\n  // monitor\n  tenantId?: string;\n  clientId?: string;\n  subscriptionId?: string;\n\n  // logs\n  /** @deprecated Azure Logs credentials */\n  azureLogAnalyticsSameAs?: boolean;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsTenantId?: string;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsClientId?: string;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsSubscriptionId?: string;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsDefaultWorkspace?: string;\n\n  // App Insights\n  appInsightsAppId?: string;\n}\n\nexport interface AzureDataSourceSecureJsonData {\n  clientSecret?: string;\n  appInsightsApiKey?: string;\n}\n\n// Represents an errors that come back from frontend requests.\n// Not totally sure how accurate this type is.\nexport type AzureMonitorErrorish = Error;\n\n// Azure Monitor API Types\nexport interface AzureMonitorMetricsMetadataResponse {\n  value: AzureMonitorMetricMetadataItem[];\n}\n\nexport interface AzureMonitorMetricMetadataItem {\n  id: string;\n  resourceId: string;\n  primaryAggregationType: string;\n  supportedAggregationTypes: string[];\n  name: AzureMonitorLocalizedValue;\n  dimensions?: AzureMonitorLocalizedValue[];\n  metricAvailabilities?: AzureMonitorMetricAvailabilityMetadata[];\n}\n\nexport interface AzureMonitorMetricAvailabilityMetadata {\n  timeGrain: string;\n  retention: string;\n}\n\nexport interface AzureMonitorLocalizedValue {\n  value: string;\n  localizedValue: string;\n}\n\nexport interface AzureMonitorMetricDefinitionsResponse {\n  data: {\n    value: Array<{ name: string; type: string; location?: string }>;\n  };\n  status: number;\n  statusText: string;\n}\n\nexport interface AzureMonitorResourceGroupsResponse {\n  data: {\n    value: Array<{ name: string }>;\n  };\n  status: number;\n  statusText: string;\n}\n\nexport interface AzureLogsVariable {\n  text: string;\n  value: string;\n}\n\nexport interface AzureLogsTableData extends TableData {\n  columns: AzureLogsTableColumn[];\n  rows: any[];\n  type: string;\n}\n\nexport interface AzureLogsTableColumn {\n  text: string;\n  type: string;\n}\n\nexport interface AzureMonitorOption<T = string> {\n  label: string;\n  value: T;\n  options?: AzureMonitorOption[];\n}\n\nexport interface AzureQueryEditorFieldProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  subscriptionId?: string;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n\n  onQueryChange: (newQuery: AzureMonitorQuery) => void;\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\nexport interface AzureResourceSummaryItem {\n  subscriptionName: string;\n  resourceGroupName: string | undefined;\n  resourceName: string | undefined;\n}\n\nexport interface RawAzureSubscriptionItem {\n  subscriptionName: string;\n  subscriptionId: string;\n}\n\nexport interface RawAzureResourceGroupItem {\n  resourceGroupURI: string;\n  resourceGroupName: string;\n}\n\nexport interface RawAzureResourceItem {\n  id: string;\n  name: string;\n  subscriptionId: string;\n  resourceGroup: string;\n  type: string;\n  location: string;\n}\n\nexport interface AzureGraphResponse<T = unknown> {\n  data: T;\n  // skipToken is used for pagination, to get the next page\n  $skipToken?: string;\n}\n\n// https://docs.microsoft.com/en-us/rest/api/azureresourcegraph/resourcegraph(2021-03-01)/resources/resources#queryrequestoptions\nexport interface AzureResourceGraphOptions {\n  $skip: number;\n  $skipToken: string;\n  $top: number;\n  allowPartialScopes: boolean;\n  resultFormat: 'objectArray' | 'table';\n}\n","import { map } from 'lodash';\nimport { rangeUtil } from '@grafana/data';\nimport TimegrainConverter from '../time_grain_converter';\nimport { AzureMonitorOption } from '../types';\n\nexport const hasOption = (options: AzureMonitorOption[], value: string): boolean =>\n  options.some((v) => (v.options ? hasOption(v.options, value) : v.value === value));\n\nexport const findOptions = (options: AzureMonitorOption[], values: string[] = []) => {\n  if (values.length === 0) {\n    return [];\n  }\n  const set = values.reduce((accum, item) => {\n    accum.add(item);\n    return accum;\n  }, new Set());\n  return options.filter((option) => set.has(option.value));\n};\n\nexport const toOption = (v: { text: string; value: string }) => ({ value: v.value, label: v.text });\n\nexport function convertTimeGrainsToMs<T extends { value: string }>(timeGrains: T[]) {\n  const allowedTimeGrainsMs: number[] = [];\n  timeGrains.forEach((tg: any) => {\n    if (tg.value !== 'auto') {\n      allowedTimeGrainsMs.push(rangeUtil.intervalToMs(TimegrainConverter.createKbnUnitFromISO8601Duration(tg.value)));\n    }\n  });\n  return allowedTimeGrainsMs;\n}\n\n// Route definitions shared with the backend.\n// Check: /pkg/tsdb/azuremonitor/azuremonitor-resource-handler.go <registerRoutes>\nexport const routeNames = {\n  azureMonitor: 'azuremonitor',\n  logAnalytics: 'loganalytics',\n  appInsights: 'appinsights',\n  resourceGraph: 'resourcegraph',\n};\n\nexport function interpolateVariable(value: any, variable: { multi: any; includeAll: any }) {\n  if (typeof value === 'string') {\n    if (variable.multi || variable.includeAll) {\n      return \"'\" + value + \"'\";\n    } else {\n      return value;\n    }\n  }\n\n  if (typeof value === 'number') {\n    return value;\n  }\n\n  const quotedValues = map(value, (val) => {\n    if (typeof value === 'number') {\n      return value;\n    }\n\n    return \"'\" + val + \"'\";\n  });\n  return quotedValues.join(',');\n}\n","import { setKustoQuery } from '../components/LogsQueryEditor/setQueryValue';\nimport {\n  appendDimensionFilter,\n  setTimeGrain as setMetricsTimeGrain,\n} from '../components/MetricsQueryEditor/setQueryValue';\nimport TimegrainConverter from '../time_grain_converter';\nimport { AzureMonitorQuery, AzureQueryType, DeprecatedAzureQueryType } from '../types';\n\nconst OLD_DEFAULT_DROPDOWN_VALUE = 'select';\n\nexport default function migrateQuery(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  // The old angular controller also had a `migrateApplicationInsightsKeys` migraiton that\n  // migrated old properties to other properties that still do not appear to be used anymore, so\n  // we decided to not include that migration anymore\n  // See https://github.com/grafana/grafana/blob/a6a09add/public/app/plugins/datasource/grafana-azure-monitor-datasource/query_ctrl.ts#L269-L288\n\n  workingQuery = migrateTimeGrains(workingQuery);\n  workingQuery = migrateLogAnalyticsToFromTimes(workingQuery);\n  workingQuery = migrateToDefaultNamespace(workingQuery);\n  workingQuery = migrateApplicationInsightsDimensions(workingQuery);\n  workingQuery = migrateMetricsDimensionFilters(workingQuery);\n\n  return workingQuery;\n}\n\nfunction migrateTimeGrains(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  if (workingQuery.azureMonitor?.timeGrainUnit && workingQuery.azureMonitor.timeGrain !== 'auto') {\n    const newTimeGrain = TimegrainConverter.createISO8601Duration(\n      workingQuery.azureMonitor.timeGrain ?? 'auto',\n      workingQuery.azureMonitor.timeGrainUnit\n    );\n    workingQuery = setMetricsTimeGrain(workingQuery, newTimeGrain);\n\n    delete workingQuery.azureMonitor?.timeGrainUnit;\n  }\n\n  if (workingQuery.appInsights?.timeGrainUnit && workingQuery.appInsights.timeGrain !== 'auto') {\n    const appInsights = {\n      ...workingQuery.appInsights,\n    };\n\n    if (workingQuery.appInsights.timeGrainCount) {\n      appInsights.timeGrain = TimegrainConverter.createISO8601Duration(\n        workingQuery.appInsights.timeGrainCount,\n        workingQuery.appInsights.timeGrainUnit\n      );\n    } else {\n      appInsights.timeGrainCount = workingQuery.appInsights.timeGrain;\n\n      if (workingQuery.appInsights.timeGrain) {\n        appInsights.timeGrain = TimegrainConverter.createISO8601Duration(\n          workingQuery.appInsights.timeGrain,\n          workingQuery.appInsights.timeGrainUnit\n        );\n      }\n    }\n\n    workingQuery = {\n      ...workingQuery,\n      appInsights: appInsights,\n    };\n  }\n\n  return workingQuery;\n}\n\nfunction migrateLogAnalyticsToFromTimes(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  if (workingQuery.azureLogAnalytics?.query?.match(/\\$__from\\s/gi)) {\n    workingQuery = setKustoQuery(\n      workingQuery,\n      workingQuery.azureLogAnalytics.query.replace(/\\$__from\\s/gi, '$__timeFrom() ')\n    );\n  }\n\n  if (workingQuery.azureLogAnalytics?.query?.match(/\\$__to\\s/gi)) {\n    workingQuery = setKustoQuery(\n      workingQuery,\n      workingQuery.azureLogAnalytics.query.replace(/\\$__to\\s/gi, '$__timeTo() ')\n    );\n  }\n\n  return workingQuery;\n}\n\nfunction migrateToDefaultNamespace(query: AzureMonitorQuery): AzureMonitorQuery {\n  const haveMetricNamespace =\n    query.azureMonitor?.metricNamespace && query.azureMonitor.metricNamespace !== OLD_DEFAULT_DROPDOWN_VALUE;\n\n  if (!haveMetricNamespace && query.azureMonitor?.metricDefinition) {\n    return {\n      ...query,\n      azureMonitor: {\n        ...query.azureMonitor,\n        metricNamespace: query.azureMonitor.metricDefinition,\n      },\n    };\n  }\n\n  return query;\n}\n\nfunction migrateApplicationInsightsDimensions(query: AzureMonitorQuery): AzureMonitorQuery {\n  const dimension = query?.appInsights?.dimension as unknown;\n\n  if (dimension && typeof dimension === 'string') {\n    return {\n      ...query,\n      appInsights: {\n        ...query.appInsights,\n        dimension: [dimension],\n      },\n    };\n  }\n\n  return query;\n}\n\n// Exported because its also used directly in the datasource.ts for some reason\nfunction migrateMetricsDimensionFilters(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  const oldDimension = workingQuery.azureMonitor?.dimension;\n  if (oldDimension && oldDimension !== 'None') {\n    workingQuery = appendDimensionFilter(workingQuery, oldDimension, 'eq', workingQuery.azureMonitor?.dimensionFilter);\n  }\n\n  return workingQuery;\n}\n\n// datasource.ts also contains some migrations, which have been moved to here. Unsure whether\n// they should also do all the other migrations...\nexport function datasourceMigrations(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  if (workingQuery.queryType === DeprecatedAzureQueryType.ApplicationInsights && workingQuery.appInsights?.rawQuery) {\n    workingQuery = {\n      ...workingQuery,\n      queryType: DeprecatedAzureQueryType.InsightsAnalytics,\n      appInsights: undefined,\n      insightsAnalytics: {\n        query: workingQuery.appInsights.rawQuery,\n        resultFormat: 'time_series',\n      },\n    };\n  }\n\n  if (!workingQuery.queryType) {\n    workingQuery = {\n      ...workingQuery,\n      queryType: AzureQueryType.AzureMonitor,\n    };\n  }\n\n  if (workingQuery.queryType === AzureQueryType.AzureMonitor && workingQuery.azureMonitor) {\n    workingQuery = migrateMetricsDimensionFilters(workingQuery);\n  }\n\n  return workingQuery;\n}\n","import { useState, useCallback, useMemo } from 'react';\nimport { AzureMonitorErrorish } from '../types';\nimport messageFromError from './messageFromError';\n\ntype SourcedError = [string, AzureMonitorErrorish];\n\nexport default function useLastError() {\n  const [errors, setErrors] = useState<SourcedError[]>([]);\n\n  // Handles errors from any child components that request data to display their options\n  const addError = useCallback((errorSource: string, error: AzureMonitorErrorish | undefined) => {\n    setErrors((errors) => {\n      const errorsCopy = [...errors];\n      const index = errors.findIndex(([vSource]) => vSource === errorSource);\n\n      // If there's already an error, remove it. If we're setting a new error\n      // below, we'll move it to the front\n      if (index > -1) {\n        errorsCopy.splice(index, 1);\n      }\n\n      // And then add the new error to the top of the array. If error is defined, it was already\n      // removed above.\n      if (error) {\n        errorsCopy.unshift([errorSource, error]);\n      }\n\n      return errorsCopy;\n    });\n  }, []);\n\n  const errorMessage = useMemo(() => {\n    const recentError = errors[0];\n    return recentError && messageFromError(recentError[1]);\n  }, [errors]);\n\n  return [errorMessage, addError] as const;\n}\n","function n(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];if(\"production\"!==process.env.NODE_ENV){var i=Y[n],o=i?\"function\"==typeof i?i.apply(null,t):i:\"unknown error nr: \"+n;throw Error(\"[Immer] \"+o)}throw Error(\"[Immer] minified error nr: \"+n+(t.length?\" \"+t.map((function(n){return\"'\"+n+\"'\"})).join(\",\"):\"\")+\". Find the full error at: https://bit.ly/3cXEKWf\")}function r(n){return!!n&&!!n[Q]}function t(n){return!!n&&(function(n){if(!n||\"object\"!=typeof n)return!1;var r=Object.getPrototypeOf(n);if(null===r)return!0;var t=Object.hasOwnProperty.call(r,\"constructor\")&&r.constructor;return t===Object||\"function\"==typeof t&&Function.toString.call(t)===Z}(n)||Array.isArray(n)||!!n[L]||!!n.constructor[L]||s(n)||v(n))}function e(t){return r(t)||n(23,t),t[Q].t}function i(n,r,t){void 0===t&&(t=!1),0===o(n)?(t?Object.keys:nn)(n).forEach((function(e){t&&\"symbol\"==typeof e||r(e,n[e],n)})):n.forEach((function(t,e){return r(e,t,n)}))}function o(n){var r=n[Q];return r?r.i>3?r.i-4:r.i:Array.isArray(n)?1:s(n)?2:v(n)?3:0}function u(n,r){return 2===o(n)?n.has(r):Object.prototype.hasOwnProperty.call(n,r)}function a(n,r){return 2===o(n)?n.get(r):n[r]}function f(n,r,t){var e=o(n);2===e?n.set(r,t):3===e?(n.delete(r),n.add(t)):n[r]=t}function c(n,r){return n===r?0!==n||1/n==1/r:n!=n&&r!=r}function s(n){return X&&n instanceof Map}function v(n){return q&&n instanceof Set}function p(n){return n.o||n.t}function l(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var r=rn(n);delete r[Q];for(var t=nn(r),e=0;e<t.length;e++){var i=t[e],o=r[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]})}return Object.create(Object.getPrototypeOf(n),r)}function d(n,e){return void 0===e&&(e=!1),y(n)||r(n)||!t(n)?n:(o(n)>1&&(n.set=n.add=n.clear=n.delete=h),Object.freeze(n),e&&i(n,(function(n,r){return d(r,!0)}),!0),n)}function h(){n(2)}function y(n){return null==n||\"object\"!=typeof n||Object.isFrozen(n)}function b(r){var t=tn[r];return t||n(18,r),t}function m(n,r){tn[n]||(tn[n]=r)}function _(){return\"production\"===process.env.NODE_ENV||U||n(0),U}function j(n,r){r&&(b(\"Patches\"),n.u=[],n.s=[],n.v=r)}function O(n){g(n),n.p.forEach(S),n.p=null}function g(n){n===U&&(U=n.l)}function w(n){return U={p:[],l:U,h:n,m:!0,_:0}}function S(n){var r=n[Q];0===r.i||1===r.i?r.j():r.O=!0}function P(r,e){e._=e.p.length;var i=e.p[0],o=void 0!==r&&r!==i;return e.h.g||b(\"ES5\").S(e,r,o),o?(i[Q].P&&(O(e),n(4)),t(r)&&(r=M(e,r),e.l||x(e,r)),e.u&&b(\"Patches\").M(i[Q].t,r,e.u,e.s)):r=M(e,i,[]),O(e),e.u&&e.v(e.u,e.s),r!==H?r:void 0}function M(n,r,t){if(y(r))return r;var e=r[Q];if(!e)return i(r,(function(i,o){return A(n,e,r,i,o,t)}),!0),r;if(e.A!==n)return r;if(!e.P)return x(n,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=4===e.i||5===e.i?e.o=l(e.k):e.o;i(3===e.i?new Set(o):o,(function(r,i){return A(n,e,o,r,i,t)})),x(n,o,!1),t&&n.u&&b(\"Patches\").R(e,t,n.u,n.s)}return e.o}function A(e,i,o,a,c,s){if(\"production\"!==process.env.NODE_ENV&&c===o&&n(5),r(c)){var v=M(e,c,s&&i&&3!==i.i&&!u(i.D,a)?s.concat(a):void 0);if(f(o,a,v),!r(v))return;e.m=!1}if(t(c)&&!y(c)){if(!e.h.F&&e._<1)return;M(e,c),i&&i.A.l||x(e,c)}}function x(n,r,t){void 0===t&&(t=!1),n.h.F&&n.m&&d(r,t)}function z(n,r){var t=n[Q];return(t?p(t):n)[r]}function I(n,r){if(r in n)for(var t=Object.getPrototypeOf(n);t;){var e=Object.getOwnPropertyDescriptor(t,r);if(e)return e;t=Object.getPrototypeOf(t)}}function k(n){n.P||(n.P=!0,n.l&&k(n.l))}function E(n){n.o||(n.o=l(n.t))}function R(n,r,t){var e=s(r)?b(\"MapSet\").N(r,t):v(r)?b(\"MapSet\").T(r,t):n.g?function(n,r){var t=Array.isArray(n),e={i:t?1:0,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:n,k:null,o:null,j:null,C:!1},i=e,o=en;t&&(i=[e],o=on);var u=Proxy.revocable(i,o),a=u.revoke,f=u.proxy;return e.k=f,e.j=a,f}(r,t):b(\"ES5\").J(r,t);return(t?t.A:_()).p.push(e),e}function D(e){return r(e)||n(22,e),function n(r){if(!t(r))return r;var e,u=r[Q],c=o(r);if(u){if(!u.P&&(u.i<4||!b(\"ES5\").K(u)))return u.t;u.I=!0,e=F(r,c),u.I=!1}else e=F(r,c);return i(e,(function(r,t){u&&a(u.t,r)===t||f(e,r,n(t))})),3===c?new Set(e):e}(e)}function F(n,r){switch(r){case 2:return new Map(n);case 3:return Array.from(n)}return l(n)}function N(){function t(n,r){var t=s[n];return t?t.enumerable=r:s[n]=t={configurable:!0,enumerable:r,get:function(){var r=this[Q];return\"production\"!==process.env.NODE_ENV&&f(r),en.get(r,n)},set:function(r){var t=this[Q];\"production\"!==process.env.NODE_ENV&&f(t),en.set(t,n,r)}},t}function e(n){for(var r=n.length-1;r>=0;r--){var t=n[r][Q];if(!t.P)switch(t.i){case 5:a(t)&&k(t);break;case 4:o(t)&&k(t)}}}function o(n){for(var r=n.t,t=n.k,e=nn(t),i=e.length-1;i>=0;i--){var o=e[i];if(o!==Q){var a=r[o];if(void 0===a&&!u(r,o))return!0;var f=t[o],s=f&&f[Q];if(s?s.t!==a:!c(f,a))return!0}}var v=!!r[Q];return e.length!==nn(r).length+(v?0:1)}function a(n){var r=n.k;if(r.length!==n.t.length)return!0;var t=Object.getOwnPropertyDescriptor(r,r.length-1);if(t&&!t.get)return!0;for(var e=0;e<r.length;e++)if(!r.hasOwnProperty(e))return!0;return!1}function f(r){r.O&&n(3,JSON.stringify(p(r)))}var s={};m(\"ES5\",{J:function(n,r){var e=Array.isArray(n),i=function(n,r){if(n){for(var e=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(e,\"\"+i,t(i,!0));return e}var o=rn(r);delete o[Q];for(var u=nn(o),a=0;a<u.length;a++){var f=u[a];o[f]=t(f,n||!!o[f].enumerable)}return Object.create(Object.getPrototypeOf(r),o)}(e,n),o={i:e?5:4,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:n,k:i,o:null,O:!1,C:!1};return Object.defineProperty(i,Q,{value:o,writable:!0}),i},S:function(n,t,o){o?r(t)&&t[Q].A===n&&e(n.p):(n.u&&function n(r){if(r&&\"object\"==typeof r){var t=r[Q];if(t){var e=t.t,o=t.k,f=t.D,c=t.i;if(4===c)i(o,(function(r){r!==Q&&(void 0!==e[r]||u(e,r)?f[r]||n(o[r]):(f[r]=!0,k(t)))})),i(e,(function(n){void 0!==o[n]||u(o,n)||(f[n]=!1,k(t))}));else if(5===c){if(a(t)&&(k(t),f.length=!0),o.length<e.length)for(var s=o.length;s<e.length;s++)f[s]=!1;else for(var v=e.length;v<o.length;v++)f[v]=!0;for(var p=Math.min(o.length,e.length),l=0;l<p;l++)o.hasOwnProperty(l)||(f[l]=!0),void 0===f[l]&&n(o[l])}}}}(n.p[0]),e(n.p))},K:function(n){return 4===n.i?o(n):a(n)}})}function T(){function e(n){if(!t(n))return n;if(Array.isArray(n))return n.map(e);if(s(n))return new Map(Array.from(n.entries()).map((function(n){return[n[0],e(n[1])]})));if(v(n))return new Set(Array.from(n).map(e));var r=Object.create(Object.getPrototypeOf(n));for(var i in n)r[i]=e(n[i]);return u(n,L)&&(r[L]=n[L]),r}function f(n){return r(n)?e(n):n}var c=\"add\";m(\"Patches\",{$:function(r,t){return t.forEach((function(t){for(var i=t.path,u=t.op,f=r,s=0;s<i.length-1;s++){var v=o(f),p=\"\"+i[s];0!==v&&1!==v||\"__proto__\"!==p&&\"constructor\"!==p||n(24),\"function\"==typeof f&&\"prototype\"===p&&n(24),\"object\"!=typeof(f=a(f,p))&&n(15,i.join(\"/\"))}var l=o(f),d=e(t.value),h=i[i.length-1];switch(u){case\"replace\":switch(l){case 2:return f.set(h,d);case 3:n(16);default:return f[h]=d}case c:switch(l){case 1:return\"-\"===h?f.push(d):f.splice(h,0,d);case 2:return f.set(h,d);case 3:return f.add(d);default:return f[h]=d}case\"remove\":switch(l){case 1:return f.splice(h,1);case 2:return f.delete(h);case 3:return f.delete(t.value);default:return delete f[h]}default:n(17,u)}})),r},R:function(n,r,t,e){switch(n.i){case 0:case 4:case 2:return function(n,r,t,e){var o=n.t,s=n.o;i(n.D,(function(n,i){var v=a(o,n),p=a(s,n),l=i?u(o,n)?\"replace\":c:\"remove\";if(v!==p||\"replace\"!==l){var d=r.concat(n);t.push(\"remove\"===l?{op:l,path:d}:{op:l,path:d,value:p}),e.push(l===c?{op:\"remove\",path:d}:\"remove\"===l?{op:c,path:d,value:f(v)}:{op:\"replace\",path:d,value:f(v)})}}))}(n,r,t,e);case 5:case 1:return function(n,r,t,e){var i=n.t,o=n.D,u=n.o;if(u.length<i.length){var a=[u,i];i=a[0],u=a[1];var s=[e,t];t=s[0],e=s[1]}for(var v=0;v<i.length;v++)if(o[v]&&u[v]!==i[v]){var p=r.concat([v]);t.push({op:\"replace\",path:p,value:f(u[v])}),e.push({op:\"replace\",path:p,value:f(i[v])})}for(var l=i.length;l<u.length;l++){var d=r.concat([l]);t.push({op:c,path:d,value:f(u[l])})}i.length<u.length&&e.push({op:\"replace\",path:r.concat([\"length\"]),value:i.length})}(n,r,t,e);case 3:return function(n,r,t,e){var i=n.t,o=n.o,u=0;i.forEach((function(n){if(!o.has(n)){var i=r.concat([u]);t.push({op:\"remove\",path:i,value:n}),e.unshift({op:c,path:i,value:n})}u++})),u=0,o.forEach((function(n){if(!i.has(n)){var o=r.concat([u]);t.push({op:c,path:o,value:n}),e.unshift({op:\"remove\",path:o,value:n})}u++}))}(n,r,t,e)}},M:function(n,r,t,e){t.push({op:\"replace\",path:[],value:r===H?void 0:r}),e.push({op:\"replace\",path:[],value:n})}})}function C(){function r(n,r){function t(){this.constructor=n}a(n,r),n.prototype=(t.prototype=r.prototype,new t)}function e(n){n.o||(n.D=new Map,n.o=new Map(n.t))}function o(n){n.o||(n.o=new Set,n.t.forEach((function(r){if(t(r)){var e=R(n.A.h,r,n);n.p.set(r,e),n.o.add(e)}else n.o.add(r)})))}function u(r){r.O&&n(3,JSON.stringify(p(r)))}var a=function(n,r){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t])})(n,r)},f=function(){function n(n,r){return this[Q]={i:2,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,D:void 0,t:n,k:this,C:!1,O:!1},this}r(n,Map);var o=n.prototype;return Object.defineProperty(o,\"size\",{get:function(){return p(this[Q]).size}}),o.has=function(n){return p(this[Q]).has(n)},o.set=function(n,r){var t=this[Q];return u(t),p(t).has(n)&&p(t).get(n)===r||(e(t),k(t),t.D.set(n,!0),t.o.set(n,r),t.D.set(n,!0)),this},o.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),e(r),k(r),r.t.has(n)?r.D.set(n,!1):r.D.delete(n),r.o.delete(n),!0},o.clear=function(){var n=this[Q];u(n),p(n).size&&(e(n),k(n),n.D=new Map,i(n.t,(function(r){n.D.set(r,!1)})),n.o.clear())},o.forEach=function(n,r){var t=this;p(this[Q]).forEach((function(e,i){n.call(r,t.get(i),i,t)}))},o.get=function(n){var r=this[Q];u(r);var i=p(r).get(n);if(r.I||!t(i))return i;if(i!==r.t.get(n))return i;var o=R(r.A.h,i,r);return e(r),r.o.set(n,o),o},o.keys=function(){return p(this[Q]).keys()},o.values=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.values()},n.next=function(){var n=t.next();return n.done?n:{done:!1,value:r.get(n.value)}},n},o.entries=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.entries()},n.next=function(){var n=t.next();if(n.done)return n;var e=r.get(n.value);return{done:!1,value:[n.value,e]}},n},o[V]=function(){return this.entries()},n}(),c=function(){function n(n,r){return this[Q]={i:3,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,t:n,k:this,p:new Map,O:!1,C:!1},this}r(n,Set);var t=n.prototype;return Object.defineProperty(t,\"size\",{get:function(){return p(this[Q]).size}}),t.has=function(n){var r=this[Q];return u(r),r.o?!!r.o.has(n)||!(!r.p.has(n)||!r.o.has(r.p.get(n))):r.t.has(n)},t.add=function(n){var r=this[Q];return u(r),this.has(n)||(o(r),k(r),r.o.add(n)),this},t.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),o(r),k(r),r.o.delete(n)||!!r.p.has(n)&&r.o.delete(r.p.get(n))},t.clear=function(){var n=this[Q];u(n),p(n).size&&(o(n),k(n),n.o.clear())},t.values=function(){var n=this[Q];return u(n),o(n),n.o.values()},t.entries=function(){var n=this[Q];return u(n),o(n),n.o.entries()},t.keys=function(){return this.values()},t[V]=function(){return this.values()},t.forEach=function(n,r){for(var t=this.values(),e=t.next();!e.done;)n.call(r,e.value,e.value,this),e=t.next()},n}();m(\"MapSet\",{N:function(n,r){return new f(n,r)},T:function(n,r){return new c(n,r)}})}function J(){N(),C(),T()}function K(n){return n}function $(n){return n}var G,U,W=\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol(\"x\"),X=\"undefined\"!=typeof Map,q=\"undefined\"!=typeof Set,B=\"undefined\"!=typeof Proxy&&void 0!==Proxy.revocable&&\"undefined\"!=typeof Reflect,H=W?Symbol.for(\"immer-nothing\"):((G={})[\"immer-nothing\"]=!0,G),L=W?Symbol.for(\"immer-draftable\"):\"__$immer_draftable\",Q=W?Symbol.for(\"immer-state\"):\"__$immer_state\",V=\"undefined\"!=typeof Symbol&&Symbol.iterator||\"@@iterator\",Y={0:\"Illegal state\",1:\"Immer drafts cannot have computed properties\",2:\"This object has been frozen and should not be mutated\",3:function(n){return\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \"+n},4:\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",5:\"Immer forbids circular references\",6:\"The first or second argument to `produce` must be a function\",7:\"The third argument to `produce` must be a function or undefined\",8:\"First argument to `createDraft` must be a plain object, an array, or an immerable object\",9:\"First argument to `finishDraft` must be a draft returned by `createDraft`\",10:\"The given draft is already finalized\",11:\"Object.defineProperty() cannot be used on an Immer draft\",12:\"Object.setPrototypeOf() cannot be used on an Immer draft\",13:\"Immer only supports deleting array indices\",14:\"Immer only supports setting array indices and the 'length' property\",15:function(n){return\"Cannot apply patch, path doesn't resolve: \"+n},16:'Sets cannot have \"replace\" patches.',17:function(n){return\"Unsupported patch operation: \"+n},18:function(n){return\"The plugin for '\"+n+\"' has not been loaded into Immer. To enable the plugin, import and call `enable\"+n+\"()` when initializing your application.\"},20:\"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\",21:function(n){return\"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '\"+n+\"'\"},22:function(n){return\"'current' expects a draft, got: \"+n},23:function(n){return\"'original' expects a draft, got: \"+n},24:\"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"},Z=\"\"+Object.prototype.constructor,nn=\"undefined\"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,rn=Object.getOwnPropertyDescriptors||function(n){var r={};return nn(n).forEach((function(t){r[t]=Object.getOwnPropertyDescriptor(n,t)})),r},tn={},en={get:function(n,r){if(r===Q)return n;var e=p(n);if(!u(e,r))return function(n,r,t){var e,i=I(r,t);return i?\"value\"in i?i.value:null===(e=i.get)||void 0===e?void 0:e.call(n.k):void 0}(n,e,r);var i=e[r];return n.I||!t(i)?i:i===z(n.t,r)?(E(n),n.o[r]=R(n.A.h,i,n)):i},has:function(n,r){return r in p(n)},ownKeys:function(n){return Reflect.ownKeys(p(n))},set:function(n,r,t){var e=I(p(n),r);if(null==e?void 0:e.set)return e.set.call(n.k,t),!0;if(!n.P){var i=z(p(n),r),o=null==i?void 0:i[Q];if(o&&o.t===t)return n.o[r]=t,n.D[r]=!1,!0;if(c(t,i)&&(void 0!==t||u(n.t,r)))return!0;E(n),k(n)}return n.o[r]===t&&\"number\"!=typeof t&&(void 0!==t||r in n.o)||(n.o[r]=t,n.D[r]=!0,!0)},deleteProperty:function(n,r){return void 0!==z(n.t,r)||r in n.t?(n.D[r]=!1,E(n),k(n)):delete n.D[r],n.o&&delete n.o[r],!0},getOwnPropertyDescriptor:function(n,r){var t=p(n),e=Reflect.getOwnPropertyDescriptor(t,r);return e?{writable:!0,configurable:1!==n.i||\"length\"!==r,enumerable:e.enumerable,value:t[r]}:e},defineProperty:function(){n(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){n(12)}},on={};i(en,(function(n,r){on[n]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}})),on.deleteProperty=function(r,t){return\"production\"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&n(13),on.set.call(this,r,t,void 0)},on.set=function(r,t,e){return\"production\"!==process.env.NODE_ENV&&\"length\"!==t&&isNaN(parseInt(t))&&n(14),en.set.call(this,r[0],t,e,r[0])};var un=function(){function e(r){var e=this;this.g=B,this.F=!0,this.produce=function(r,i,o){if(\"function\"==typeof r&&\"function\"!=typeof i){var u=i;i=r;var a=e;return function(n){var r=this;void 0===n&&(n=u);for(var t=arguments.length,e=Array(t>1?t-1:0),o=1;o<t;o++)e[o-1]=arguments[o];return a.produce(n,(function(n){var t;return(t=i).call.apply(t,[r,n].concat(e))}))}}var f;if(\"function\"!=typeof i&&n(6),void 0!==o&&\"function\"!=typeof o&&n(7),t(r)){var c=w(e),s=R(e,r,void 0),v=!0;try{f=i(s),v=!1}finally{v?O(c):g(c)}return\"undefined\"!=typeof Promise&&f instanceof Promise?f.then((function(n){return j(c,o),P(n,c)}),(function(n){throw O(c),n})):(j(c,o),P(f,c))}if(!r||\"object\"!=typeof r){if(void 0===(f=i(r))&&(f=r),f===H&&(f=void 0),e.F&&d(f,!0),o){var p=[],l=[];b(\"Patches\").M(r,f,p,l),o(p,l)}return f}n(21,r)},this.produceWithPatches=function(n,r){if(\"function\"==typeof n)return function(r){for(var t=arguments.length,i=Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return e.produceWithPatches(r,(function(r){return n.apply(void 0,[r].concat(i))}))};var t,i,o=e.produce(n,r,(function(n,r){t=n,i=r}));return\"undefined\"!=typeof Promise&&o instanceof Promise?o.then((function(n){return[n,t,i]})):[o,t,i]},\"boolean\"==typeof(null==r?void 0:r.useProxies)&&this.setUseProxies(r.useProxies),\"boolean\"==typeof(null==r?void 0:r.autoFreeze)&&this.setAutoFreeze(r.autoFreeze)}var i=e.prototype;return i.createDraft=function(e){t(e)||n(8),r(e)&&(e=D(e));var i=w(this),o=R(this,e,void 0);return o[Q].C=!0,g(i),o},i.finishDraft=function(r,t){var e=r&&r[Q];\"production\"!==process.env.NODE_ENV&&(e&&e.C||n(9),e.I&&n(10));var i=e.A;return j(i,t),P(void 0,i)},i.setAutoFreeze=function(n){this.F=n},i.setUseProxies=function(r){r&&!B&&n(20),this.g=r},i.applyPatches=function(n,t){var e;for(e=t.length-1;e>=0;e--){var i=t[e];if(0===i.path.length&&\"replace\"===i.op){n=i.value;break}}e>-1&&(t=t.slice(e+1));var o=b(\"Patches\").$;return r(n)?o(n,t):this.produce(n,(function(n){return o(n,t)}))},e}(),an=new un,fn=an.produce,cn=an.produceWithPatches.bind(an),sn=an.setAutoFreeze.bind(an),vn=an.setUseProxies.bind(an),pn=an.applyPatches.bind(an),ln=an.createDraft.bind(an),dn=an.finishDraft.bind(an);export default fn;export{un as Immer,pn as applyPatches,K as castDraft,$ as castImmutable,ln as createDraft,D as current,J as enableAllPlugins,N as enableES5,C as enableMapSet,T as enablePatches,dn as finishDraft,d as freeze,L as immerable,r as isDraft,t as isDraftable,H as nothing,e as original,fn as produce,cn as produceWithPatches,sn as setAutoFreeze,vn as setUseProxies};\n//# sourceMappingURL=immer.esm.js.map\n"],"names":["Field","props","InlineField","labelWidth","Deferred","constructor","this","resolve","undefined","reject","promise","Promise","Object","freeze","query","datasource","onQueryChange","monacoPromiseRef","useRef","useEffect","azureLogAnalytics","resource","promises","azureLogAnalyticsDatasource","getKustoSchema","current","all","then","schema","monaco","editor","languages","kusto","getKustoWorker","model","getModel","uri","worker","setSchema","handleEditorMount","useCallback","onChange","newQuery","setKustoQuery","CodeEditor","value","language","height","width","showMiniMap","onBlur","onSave","onEditorDidMount","FORMAT_OPTIONS","label","variableOptionGroup","options","useMemo","handleChange","change","setFormatAs","Select","menuShouldPortal","inputId","resultFormat","EntryIcon","isOpen","entry","type","ResourceRowType","Icon","name","theme","table","css","tableLayout","tableScroller","maxHeight","overflow","header","background","colors","secondary","row","borderBottom","border","weak","borderBottomColor","medium","disabledRow","opacity","cell","padding","spacing","textOverflow","collapseButton","margin","loadingCell","textAlign","spinner","marginBottom","nestedEntry","display","alignItems","entryContentItem","truncated","minWidth","whiteSpace","nestedRowCheckbox","zIndex","NestedEntry","isSelected","isDisabled","isSelectable","level","onToggleCollapse","onSelectedChange","useTheme2","styles","useStyles2","getStyles","hasChildren","children","handleToggleCollapse","handleSelectedChanged","ev","target","checked","checkboxId","id","document","getElementById","scrollIntoView","behavior","block","className","style","marginLeft","gridSize","IconButton","onClick","Space","layout","h","Checkbox","disabled","htmlFor","cx","selectedRows","requestNestedRows","onRowSelectedChange","selectableEntryTypes","rowStatus","setRowStatus","useState","find","v","length","selectedRow","findRow","async","catch","some","typeLabel","location","keys","rows","FadeTransition","visible","colSpan","LoadingPlaceholder","text","map","noHeader","resourcePickerData","resourceURI","onApply","onCancel","loadingStatus","setLoadingStatus","azureRows","setAzureRows","internalSelectedURI","setInternalSelectedURI","errorMessage","setErrorMessage","isAdvancedOpen","setIsAdvancedOpen","includes","resources","getSubscriptions","parsedURI","parseResourceURI","resourceGroupURI","subscriptionID","resourceGroup","resourceGroups","getResourceGroupsBySubscriptionId","addResources","resourcesForResourceGroup","getResourcesForResourceGroup","error","messageFromError","loadInitialData","selectedResourceRows","found","resourceGroupOrSubscription","newRows","handleSelectionChanged","handleApply","loadingWrapper","selectionFooter","Collapse","collapsible","onToggle","Label","Tooltip","content","href","rel","placement","interactive","Input","event","currentTarget","placeholder","Button","variant","Alert","severity","title","position","bottom","primary","paddingTop","paddingBottom","color","parseResourceDetails","parsed","subscriptionName","resourceGroupName","resourceName","ResourceLabel","resourceComponents","setResourceComponents","getResourceURIDisplayProperties","FormattedResource","startsWith","Separator","pickerIsOpen","setPickerIsOpen","handleOpenPicker","closePicker","setResource","Modal","modal","onDismiss","trapFocus","breakpoints","values","lg","useMigrations","migrationError","setMigrationError","workspace","isGUIDish","getResourceURIFromWorkspace","migrateWorkspaceQueryToResourceQuery","err","message","subscriptionId","setError","hideFormatAs","InlineFieldRow","kustoQuery","formatAs","setSubscriptionID","subscription","azureMonitor","metricDefinition","metricNamespace","metricName","aggregation","timeGrain","dimensionFilters","setResourceGroup","setResourceType","resourceType","setResourceName","setMetricNamespace","setMetricName","setAggregation","setTimeGrain","setDimensionFilters","dimensions","appendDimensionFilter","dimension","operator","filter","existingFilters","removeDimensionFilter","indexToRemove","newFilters","splice","setDimensionFilterValue","index","fieldName","setTop","top","setLegendAlias","alias","subscriptions","multiSelect","queryType","AzureQueryType","onSubscriptionsChange","c","MultiSelect","isClearable","findOptions","allowCustomValue","azureResourceGraph","ERROR_SOURCE","fetchedRef","setSubscriptions","azureMonitorDatasource","results","fetchedSubscriptions","description","ReadOnlyTimeGrain","timeGrainCount","timeGrainType","timeGrainUnit","timeFields","timeField","groupBy","appInsights","dimensionFilter","insightsAnalytics","readOnly","metricNamespaces","optionValues","m","concat","p","push","resourceTypes","resourceNames","metricNames","aggregationOptions","isLoading","timeGrainOptions","timeGrains","autoInterval","TimegrainConverter","o","dimensionOptions","onFieldChange","filterIndex","VerticalGroup","HorizontalGroup","InlineLabel","HTMLInputElement","onFilterInputChange","size","icon","removeFilter","setValue","handleBlur","useAsyncState","asyncFn","dependencies","errorSource","Math","random","finalValue","useSubscriptions","defaultSubscription","defaultSubscriptionId","subscriptionOptions","formatOptions","hasOption","defaultSub","updateSubscriptions","rawResults","selectedValue","toOption","option","metricsMetadata","metricMetadata","setMetricMetadata","aggOptions","supportedAggTypes","primaryAggType","getMetricMetadata","metadata","aggregations","supportedTimeGrains","newAggregation","newTimeGrain","useMetricMetadata","getResourceGroups","useResourceGroups","getMetricDefinitions","useResourceTypes","getResourceNames","useResourceNames","getMetricNames","useMetricNames","getMetricNamespaces","useMetricNamespaces","ResourceTypeField","initialQueryType","queryTypes","gtGrafana9","DeprecatedAzureQueryType","DEFAULT_QUERY","onChangeQuery","preparedQuery","withDefaults","defaults","migratedQuery","migrateQuery","deepEqual","prepareQuery","EditorForQueryType","config","LogsQueryEditor","baseQuery","onRunQuery","baseOnRunQuery","useLastError","debounce","usePreparedQuery","getVariables","RESOURCE_URI_REGEX","matches","exec","groups","input","match","toLowerCase","result","targetParentId","newResources","produce","draftState","draftRow","wrapper","defaultProps","stylesFactory","paddingRight","isAppInsightsConfigured","jsonData","appInsightsAppId","secureJsonFields","appInsightsApiKey","valid","gt","TimeGrainConverter","toUpperCase","interval","slice","unit","indexOf","createISO8601Duration","toMinutes","allowedTimeGrains","closest","intervalMs","rangeUtil","i","duration","offset","substring","timeUnitToText","timeUnitToKbn","AzureCloud","set","reduce","accum","item","add","Set","has","routeNames","logAnalytics","resourceGraph","interpolateVariable","variable","multi","includeAll","val","join","OLD_DEFAULT_DROPDOWN_VALUE","workingQuery","setMetricsTimeGrain","migrateTimeGrains","replace","migrateLogAnalyticsToFromTimes","migrateToDefaultNamespace","migrateApplicationInsightsDimensions","migrateMetricsDimensionFilters","oldDimension","datasourceMigrations","rawQuery","errors","setErrors","addError","errorsCopy","findIndex","vSource","unshift","recentError","n","r","arguments","t","Array","e","Error","Q","getPrototypeOf","hasOwnProperty","call","Function","toString","Z","isArray","L","s","nn","forEach","u","prototype","a","get","f","delete","X","Map","q","l","rn","writable","configurable","enumerable","create","d","y","clear","isFrozen","b","tn","_","U","j","O","g","S","w","P","M","x","H","A","I","k","R","D","F","z","getOwnPropertyDescriptor","E","N","T","C","en","on","Proxy","revocable","revoke","proxy","J","K","from","G","W","Symbol","B","Reflect","for","iterator","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","getOwnPropertyDescriptors","deleteProperty","defineProperty","setPrototypeOf","apply","un","produceWithPatches","useProxies","setUseProxies","autoFreeze","setAutoFreeze","createDraft","finishDraft","applyPatches","path","op","$","an","fn","bind"],"sourceRoot":""}